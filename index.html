<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>婚礼筹备管家清单 1.0 专业版 - 管家档期管理</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.css">
    <!-- 引入Chart.js用于统计图表 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 引入html2canvas用于导出图片 -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- 引入SortableJS用于拖拽功能 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <!-- 引入SheetJS用于导出Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root {
            --primary-color: #e74c3c;
            --secondary-color: #f8c8c6;
            --accent-color: #d63031;
            --light-color: #fff9f9;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --info-color: #3498db;
            --gray-light: #f5f5f5;
            --gray: #ddd;
            --gray-dark: #666;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 6px 12px rgba(0, 0, 0, 0.15);
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            padding-top: 100px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 头部样式 - 始终置顶 */
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 36px;
        }
        
        .logo h1 {
            font-size: 32px;
            font-weight: 800;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            border: 2px solid transparent;
        }
        
        .logo h1:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .logo span {
            font-size: 14px;
            background: white;
            color: var(--primary-color);
            padding: 3px 8px;
            border-radius: 4px;
            margin-left: 10px;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        /* 按钮样式 */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--accent-color);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark-color);
        }
        
        .btn-secondary:hover {
            background-color: var(--gray);
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* 导航选项卡 */
        nav {
            background-color: white;
            border-bottom: 1px solid var(--gray);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-top: 100px;
            position: sticky;
            top: 100px;
            z-index: 900;
        }
        
        .nav-tabs {
            display: flex;
            overflow-x: auto;
            white-space: nowrap;
            padding: 0;
        }
        
        .nav-tab {
            padding: 18px 24px;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            color: var(--dark-color);
        }
        
        .nav-tab:hover {
            color: var(--primary-color);
            background-color: var(--secondary-color);
        }
        
        .nav-tab.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background-color: var(--light-color);
        }
        
        .nav-tab i {
            margin-right: 8px;
        }
        
        /* 主要内容区域 */
        main {
            padding: 30px 0;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* 卡片样式 */
        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 25px;
            transition: var(--transition);
        }
        
        .card:hover {
            box-shadow: var(--shadow-hover);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--primary-color);
        }
        
        /* 档期日历样式 */
        .schedule-view-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        .view-toggle-buttons {
            display: flex;
        }
        
        .view-toggle-btn {
            padding: 10px 20px;
            border: 1px solid var(--gray);
            background: white;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .view-toggle-btn:first-child {
            border-radius: var(--border-radius) 0 0 var(--border-radius);
        }
        
        .view-toggle-btn:last-child {
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .view-toggle-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .calendar-view {
            display: none;
        }
        
        .calendar-view.active {
            display: block;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .calendar-nav-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--dark-color);
            transition: var(--transition);
        }
        
        .calendar-nav-btn:hover {
            color: var(--primary-color);
        }
        
        .calendar-month {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-color);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: var(--gray);
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            overflow: hidden;
        }
        
        .calendar-day-header {
            background-color: var(--secondary-color);
            padding: 15px 5px;
            text-align: center;
            font-weight: 700;
            color: var(--dark-color);
        }
        
        .calendar-day {
            background-color: white;
            padding: 15px 10px;
            min-height: 120px;
            position: relative;
            transition: var(--transition);
        }
        
        .calendar-day:hover {
            background-color: var(--light-color);
        }
        
        .calendar-day.empty {
            background-color: var(--gray-light);
        }
        
        .day-number {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .day-events {
            margin-top: 5px;
        }
        
        .day-event {
            background-color: var(--primary-color);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 3px;
            cursor: pointer;
            transition: var(--transition);
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        
        .day-event:hover {
            background-color: var(--accent-color);
        }
        
        .add-event-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }
        
        .add-event-btn:hover {
            color: var(--primary-color);
        }
        
        /* 列表视图样式 */
        .list-view {
            display: none;
        }
        
        .list-view.active {
            display: block;
        }
        
        .month-section {
            margin-bottom: 30px;
        }
        
        .month-header {
            background-color: var(--secondary-color);
            padding: 15px 20px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .month-events {
            background-color: white;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .event-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            transition: var(--transition);
        }
        
        .event-item:hover {
            background-color: var(--light-color);
        }
        
        .event-date {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-color);
            color: white;
            width: 70px;
            height: 70px;
            border-radius: var(--border-radius);
            margin-right: 20px;
            flex-shrink: 0;
        }
        
        .event-day {
            font-size: 24px;
            font-weight: 700;
            line-height: 1;
        }
        
        .event-month {
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .event-info {
            flex: 1;
        }
        
        .event-couple {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .event-details {
            display: flex;
            gap: 15px;
            font-size: 14px;
            color: var(--gray-dark);
        }
        
        .event-actions {
            display: flex;
            gap: 10px;
        }
        
        /* 客户详情页面样式 */
        .client-info-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            padding: 40px 30px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            margin-bottom: 0;
            text-align: center;
            box-shadow: var(--shadow);
        }
        
        .client-name {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            line-height: 1.2;
        }
        
        .client-wedding-date {
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
            opacity: 0.95;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 30px;
            display: inline-flex;
        }
        
        .client-wedding-date i {
            font-size: 24px;
        }
        
        .client-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            background-color: white;
            padding: 30px;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }
        
        .info-section {
            margin-bottom: 0;
            padding: 20px;
            background-color: var(--light-color);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid var(--gray-light);
        }
        
        .info-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .info-section.groom-section {
            border-left: 5px solid var(--info-color);
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
        }
        
        .info-section.bride-section {
            border-left: 5px solid var(--primary-color);
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
        }
        
        .info-section.wedding-section {
            border-left: 5px solid var(--success-color);
            grid-column: span 2;
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
        }
        
        .info-label {
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 12px;
            border-bottom: 2px solid rgba(0,0,0,0.05);
            background: white;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .groom-section .info-label i {
            color: var(--info-color);
        }
        
        .bride-section .info-label i {
            color: var(--primary-color);
        }
        
        .wedding-section .info-label i {
            color: var(--success-color);
        }
        
        .info-item {
            margin-bottom: 15px;
            background: white;
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .info-sub-label {
            font-size: 14px;
            color: var(--gray-dark);
            margin-bottom: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        
        .info-value {
            color: var(--dark-color);
            font-size: 16px;
        }
        
        .info-value.editable {
            padding: 12px 18px;
            border: 2px solid var(--gray-light);
            border-radius: var(--border-radius);
            background-color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: inset 0 1px 4px rgba(0,0,0,0.05);
            font-size: 17px;
        }
        
        .info-value.editable:hover {
            border-color: var(--primary-color);
            background-color: rgba(231, 76, 60, 0.05);
            box-shadow: inset 0 1px 6px rgba(0,0,0,0.1);
        }
        
        .info-value.editable:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.2), inset 0 1px 4px rgba(0,0,0,0.05);
            background-color: white;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }
        
        /* 客户操作按钮样式优化 */
        .client-actions {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            margin: 30px 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            justify-content: center;
            gap: 20px;
        }
        
        .client-actions .btn {
            font-size: 16px;
            padding: 12px 30px;
        }
        
        /* 快速导航按钮优化 */
        .quick-nav {
            margin: 30px 50px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            position: sticky;
            top: 120px;
            z-index: 800;
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        .nav-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid var(--gray-light);
        }
        
        .nav-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--secondary-color) 0%, white 100%);
        }
        
        .nav-card i {
            font-size: 45px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .nav-card-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
            line-height: 1.5;
        }
        
        /* 客户操作按钮 */
        .client-actions {
            display: flex;
            gap: 15px;
            margin: 30px 40px 0;
            padding: 20px;
            background-color: var(--light-color);
            border-radius: var(--border-radius);
            justify-content: center;
        }
        
        /* 快速导航按钮 */
        .quick-nav {
            margin: 20px 40px 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 25px;
        }
        
        .nav-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 30px 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--gray-light);
        }
        
        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            background-color: var(--secondary-color);
            border-color: var(--primary-color);
        }
        
        .nav-card i {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .nav-card:hover i {
            transform: scale(1.1);
        }
        
        .nav-card-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
            line-height: 1.4;
        }
        
        /* 进度条样式 */
        .progress-container {
            margin: 20px 0;
            padding: 25px;
            background-color: var(--light-color);
            border-radius: var(--border-radius);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .progress-percent {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .progress-bar {
            height: 20px;
            background-color: var(--gray);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--accent-color) 100%);
            border-radius: 10px;
            width: 0%;
            transition: width 1s ease-in-out;
        }
        
        /* 导航按钮样式 */
        .quick-nav {
            margin: 20px 0 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            position: sticky;
            top: 160px;
            z-index: 800;
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            /* 确保粘性定位生效 */
            overflow: visible;
        }
        
        .nav-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--gray);
        }
        
        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            background-color: var(--secondary-color);
        }
        
        .nav-card i {
            font-size: 36px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .nav-card-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
        }
        
        /* 表格样式 */
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        th {
            background-color: var(--secondary-color);
            color: var(--dark-color);
            font-weight: 600;
            padding: 15px 12px;
            text-align: left;
            border-bottom: 2px solid var(--primary-color);
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        tr:hover {
            background-color: var(--light-color);
        }
        
        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.2);
        }
        
        .form-row {
            display: flex;
            gap: 20px;
        }
        
        .form-row > div {
            flex: 1;
        }
        
        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray-dark);
            transition: var(--transition);
        }
        
        .modal-close:hover {
            color: var(--primary-color);
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--dark-color);
            padding-right: 30px;
        }
        
        /* 完成状态复选框 */
        .status-checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: var(--success-color);
        }
        
        /* 编辑按钮 */
        .edit-btn {
            background: none;
            border: none;
            color: var(--info-color);
            cursor: pointer;
            padding: 5px;
            font-size: 16px;
            transition: var(--transition);
        }
        
        .edit-btn:hover {
            color: var(--primary-color);
            transform: scale(1.1);
        }
        
        /* 操作按钮组 */
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* 导出选项样式 */
        .export-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .export-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            width: 180px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .export-option:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            background-color: var(--light-color);
        }
        
        .export-option i {
            font-size: 36px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .export-option-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-color);
            text-align: center;
        }
        
        /* 页脚 */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--gray-dark);
            font-size: 14px;
            border-top: 1px solid var(--gray-light);
            margin-top: 40px;
        }
        
        /* 响应式调整 */
        /* 移动端整体布局优化 */
        @media (max-width: 768px) {
            /* 基础样式优化 */
            :root {
                --border-radius: 12px;
                --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
            
            body {
                padding-top: 70px;
                font-size: 15px;
                line-height: 1.5;
            }
            
            /* 容器优化 */
            .container {
                padding: 0 12px;
            }
            
            /* 头部优化 */
            header {
                padding: 10px 0;
            }
            
            .header-content {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                gap: 10px;
            }
            
            .logo {
                gap: 10px;
            }
            
            .logo i {
                font-size: 24px;
            }
            
            .logo h1 {
                font-size: 18px;
                font-weight: 700;
            }
            
            .logo p {
                display: none;
            }
            
            #version {
                font-size: 12px;
                padding: 2px 6px;
            }
            
            /* 头部操作按钮优化 */
            .header-actions {
                display: flex;
                gap: 8px;
            }
            
            .header-actions .btn {
                padding: 8px 12px;
                font-size: 13px;
                gap: 5px;
            }
            
            .header-actions .btn i {
                font-size: 14px;
            }
            
            /* 导航优化 */
            nav {
                margin-top: 70px;
                position: sticky;
                top: 70px;
                z-index: 900;
            }
            
            .nav-tabs {
                padding: 0;
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .nav-tabs::-webkit-scrollbar {
                display: none;
            }
            
            .nav-tab {
                padding: 12px 15px;
                font-size: 13px;
                white-space: nowrap;
                border-bottom: 3px solid transparent;
            }
            
            .nav-tab i {
                margin-right: 6px;
                font-size: 14px;
            }
            
            /* 主要内容优化 */
            main {
                padding: 15px 0;
            }
            
            /* 卡片优化 */
            .card {
                padding: 16px;
                margin-bottom: 16px;
                border-radius: var(--border-radius);
            }
            
            .card-header {
                margin-bottom: 15px;
                padding-bottom: 10px;
            }
            
            .card-title {
                font-size: 18px;
            }
            
            /* 档期视图切换优化 */
            .schedule-view-toggle {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
                padding: 12px;
            }
            
            .view-toggle-buttons {
                display: flex;
                width: 100%;
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .view-toggle-buttons::-webkit-scrollbar {
                display: none;
            }
            
            .view-toggle-btn {
                padding: 10px 16px;
                font-size: 13px;
                white-space: nowrap;
                flex-shrink: 0;
            }
            
            /* 档期按钮优化 */
            .btn-group {
                display: flex;
                gap: 8px;
                overflow-x: auto;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .btn-group::-webkit-scrollbar {
                display: none;
            }
            
            .schedule-btn {
                padding: 8px 12px;
                font-size: 12px;
                gap: 6px;
                flex-shrink: 0;
            }
            
            .schedule-count {
                font-size: 11px;
                padding: 2px 6px;
            }
            
            /* 日历视图优化 */
            .calendar-grid {
                gap: 0.5px;
            }
            
            .calendar-day-header {
                padding: 8px 2px;
                font-size: 12px;
                font-weight: 600;
            }
            
            .calendar-day {
                min-height: 80px;
                padding: 8px 5px;
            }
            
            .day-number {
                font-size: 15px;
                margin-bottom: 3px;
            }
            
            .day-event {
                font-size: 11px;
                padding: 2px 4px;
                margin-bottom: 2px;
                border-radius: 3px;
            }
            
            /* 列表视图优化 */
            .event-item {
                flex-direction: column;
                align-items: flex-start;
                padding: 15px;
                gap: 10px;
            }
            
            .event-date {
                margin-right: 0;
                margin-bottom: 0;
                width: 55px;
                height: 55px;
            }
            
            .event-day {
                font-size: 18px;
            }
            
            .event-month {
                font-size: 12px;
            }
            
            .event-info {
                width: 100%;
            }
            
            .event-couple {
                font-size: 16px;
                margin-bottom: 5px;
            }
            
            .event-details {
                flex-direction: column;
                gap: 3px;
                font-size: 13px;
            }
            
            .event-actions {
                margin-top: 10px;
                width: 100%;
                justify-content: flex-end;
                gap: 8px;
            }
            
            /* 客户详情优化 */
            .client-info-header {
                padding: 25px 20px;
            }
            
            .client-name {
                font-size: 24px;
                margin-bottom: 15px;
            }
            
            .client-wedding-date {
                font-size: 16px;
                padding: 10px 20px;
            }
            
            .client-info-grid {
                grid-template-columns: 1fr;
                padding: 15px;
                gap: 12px;
            }
            
            .info-section {
                padding: 15px;
            }
            
            .info-label {
                font-size: 16px;
                margin-bottom: 12px;
                padding: 8px 12px;
            }
            
            .info-item {
                margin-bottom: 12px;
                padding: 12px;
            }
            
            .info-sub-label {
                font-size: 13px;
                margin-bottom: 8px;
            }
            
            .info-value {
                font-size: 15px;
            }
            
            .info-value.editable {
                padding: 10px 15px;
                font-size: 15px;
            }
            
            /* 快速导航优化 */
            .quick-nav {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin: 12px;
                padding: 12px;
            }
            
            .nav-card {
                padding: 18px 12px;
                gap: 10px;
            }
            
            .nav-card i {
                font-size: 28px;
                margin-bottom: 10px;
            }
            
            .nav-card-title {
                font-size: 13px;
                text-align: center;
            }
            
            /* 表单优化 */
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
            
            label {
                font-size: 14px;
                margin-bottom: 6px;
            }
            
            input, textarea, select {
                padding: 12px 15px;
                font-size: 15px;
                border-radius: var(--border-radius);
            }
            
            textarea {
                min-height: 100px;
            }
            
            /* 按钮优化 */
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                border-radius: var(--border-radius);
                gap: 8px;
                min-height: 45px;
            }
            
            .btn-small {
                padding: 8px 15px;
                font-size: 13px;
                min-height: auto;
            }
            
            /* 表格优化 */
            .table-container {
                overflow-x: scroll;
                -webkit-overflow-scrolling: touch;
                margin-bottom: 15px;
            }
            
            table {
                min-width: 600px;
                font-size: 13px;
            }
            
            th {
                padding: 10px 8px;
                font-size: 12px;
            }
            
            td {
                padding: 10px 8px;
            }
            
            /* 模态框优化 */
            .modal-content {
                width: 98%;
                max-width: 400px;
                padding: 20px;
                margin: 10px;
                border-radius: var(--border-radius);
            }
            
            .modal-title {
                font-size: 20px;
                margin-bottom: 15px;
            }
            
            /* 操作按钮组优化 */
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            /* 导出选项优化 */
            .export-options {
                flex-direction: column;
                gap: 12px;
            }
            
            .export-option {
                width: 100%;
                padding: 20px 15px;
                gap: 10px;
            }
            
            .export-option i {
                font-size: 32px;
                margin-bottom: 10px;
            }
            
            .export-option-title {
                font-size: 14px;
            }
            
            /* 统计图表优化 */
            .stats-chart-container {
                padding: 15px;
            }
            
            .chart-container {
                height: 250px;
            }
            
            /* 客户操作按钮优化 */
            .client-actions {
                flex-direction: column;
                gap: 10px;
                margin: 15px;
                padding: 15px;
            }
            
            /* 子选项卡优化 */
            .sub-tabs {
                padding: 12px;
                gap: 8px;
                top: 110px;
            }
            
            .sub-tab {
                padding: 10px 18px;
                font-size: 13px;
            }
            
            /* 双列布局优化 */
            .two-column-layout {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            /* 进度条优化 */
            .progress-container {
                margin: 15px 0;
                padding: 20px;
            }
            
            /* 相位管理器优化 */
            .phase-manager {
                margin-bottom: 20px;
                padding: 15px;
            }
            
            .phase-list {
                gap: 8px;
                margin-bottom: 12px;
            }
            
            .phase-tag {
                padding: 6px 12px;
                font-size: 13px;
            }
        }
        
        /* 小屏幕优化 (iPhone SE, 更小屏幕) */
        @media (max-width: 480px) {
            /* 进一步压缩头部 */
            .logo h1 {
                font-size: 16px;
            }
            
            .header-actions .btn {
                padding: 7px 10px;
                font-size: 12px;
            }
            
            /* 导航标签优化 */
            .nav-tab {
                padding: 11px 12px;
                font-size: 12px;
            }
            
            .nav-tab i {
                margin-right: 4px;
                font-size: 13px;
            }
            
            /* 日历优化 */
            .calendar-day {
                min-height: 70px;
                padding: 6px 4px;
            }
            
            .day-number {
                font-size: 14px;
            }
            
            .day-event {
                font-size: 10px;
                padding: 1px 3px;
            }
            
            /* 快速导航优化 */
            .quick-nav {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .nav-card {
                flex-direction: row;
                align-items: center;
                padding: 12px 15px;
            }
            
            .nav-card i {
                font-size: 24px;
                margin-bottom: 0;
                margin-right: 12px;
            }
            
            /* 表单元素优化 */
            input, textarea, select {
                padding: 11px 14px;
                font-size: 14px;
            }
            
            /* 按钮优化 */
            .btn {
                padding: 11px 18px;
                font-size: 13px;
            }
            
            /* 事件项优化 */
            .event-item {
                padding: 12px;
            }
            
            .event-couple {
                font-size: 15px;
            }
            
            /* 模态框优化 */
            .modal-content {
                padding: 18px;
            }
            
            /* 客户详情优化 */
            .client-info-header {
                padding: 20px 15px;
            }
            
            .client-name {
                font-size: 22px;
            }
            
            .client-wedding-date {
                font-size: 15px;
                padding: 8px 16px;
            }
        }
        
        /* 移动端触摸优化 */
        .btn, .nav-tab, .event-item, .nav-card, .export-option, .sub-tab, .day-event, .calendar-day {
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        
        /* 移动端滚动优化 */
        html {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }
        
        /* 禁用文本选择，提升移动端体验 */
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* 允许表单元素和可编辑内容选择 */
        input, textarea, select, [contenteditable="true"] {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        /* 优化移动端点击反馈 */
        .btn, .nav-tab, .nav-card, .export-option, .sub-tab, .day-event, .event-item {
            transition: transform 0.1s ease, opacity 0.1s ease;
        }
        
        .btn:active, .nav-tab:active, .nav-card:active, .export-option:active, .sub-tab:active, .day-event:active, .event-item:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        
        /* 工具提示 */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark-color);
            color: white;
            text-align: center;
            padding: 8px;
            border-radius: var(--border-radius);
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            font-weight: normal;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* 子选项卡样式 - 设计成按钮 */
        .sub-tabs {
            display: flex;
            margin-bottom: 20px;
            overflow-x: auto;
            position: sticky;
            top: 160px;
            z-index: 800;
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.15);
            border-radius: var(--border-radius);
            gap: 10px;
            flex-wrap: nowrap;
        }
        
        .sub-tab {
            padding: 12px 25px;
            cursor: pointer;
            font-weight: 600;
            border: 2px solid var(--gray-light);
            background: white;
            color: var(--dark-color);
            border-radius: 30px;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .sub-tab:hover {
            color: var(--primary-color);
            border-color: var(--primary-color);
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .sub-tab.active {
            color: white;
            background: var(--primary-color);
            border-color: var(--primary-color);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        /* 分隔线样式 */
        .section-divider {
            display: flex;
            align-items: center;
            margin: 30px 0;
            color: var(--primary-color);
            font-weight: 700;
        }
        
        .section-divider::before,
        .section-divider::after {
            content: "";
            flex: 1;
            height: 2px;
            background-color: var(--primary-color);
        }
        
        .section-divider-text {
            padding: 0 15px;
            font-size: 18px;
        }
        
        /* 男方/女方区分样式 */
        .groom-section {
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }
        
        .bride-section {
            border-left: 5px solid #e74c3c;
            padding-left: 15px;
        }
        
        .section-label {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .groom-label {
            background-color: #d6eaf8;
            color: #2c3e50;
        }
        
        .bride-label {
            background-color: #fadbd8;
            color: #2c3e50;
        }
        
        /* 时间轴样式 */
        .timeline-container {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline-container::before {
            content: "";
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--gray);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            padding-left: 20px;
        }
        
        .timeline-item::before {
            content: "";
            position: absolute;
            left: -8px;
            top: 5px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--primary-color);
            border: 2px solid white;
            box-shadow: 0 0 0 2px var(--primary-color);
        }
        
        .timeline-time {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .timeline-content {
            background-color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        /* 空状态提示 */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray-dark);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: var(--gray);
        }
        
        /* 双列布局 */
        .two-column-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .two-column-layout {
                grid-template-columns: 1fr;
            }
        }
        
        /* 可拖拽时间线样式 */
        .sortable-container {
            min-height: 100px;
            padding: 10px;
        }
        
        .sortable-item {
            cursor: move;
            background-color: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border-left: 5px solid var(--primary-color);
            transition: var(--transition);
        }
        
        .sortable-item:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }
        
        .sortable-item.sortable-ghost {
            opacity: 0.4;
        }
        
        .sortable-item.sortable-drag {
            opacity: 0.8;
        }
        
        /* 编辑执行环节样式 */
        .phase-manager {
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--light-color);
            border-radius: var(--border-radius);
        }
        
        .phase-manager-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .phase-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .phase-tag {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: white;
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid var(--gray);
        }
        
        .phase-tag .delete-phase {
            color: var(--gray-dark);
            cursor: pointer;
            font-size: 12px;
        }
        
        .phase-tag .delete-phase:hover {
            color: var(--primary-color);
        }
        
        /* 客户详情操作按钮 */
        .client-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* 统计图表样式 */
        .stats-chart-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        .stats-chart-container.active {
            display: block;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* 添加任务按钮 */
        .add-task-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        /* 状态指示器样式 */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }
        
        .status-badge.green {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success-color);
        }
        
        .status-badge.yellow {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }
        
        .status-badge.red {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--primary-color);
        }
        
        /* 档期按钮样式 */
        .schedule-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            position: relative;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow);
        }
        
        .schedule-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--primary-color) 100%);
        }
        
        .schedule-btn:active {
            transform: translateY(0);
            box-shadow: var(--shadow);
        }
        
        .schedule-btn.active {
            background: linear-gradient(135deg, var(--dark-color) 0%, var(--accent-color) 100%);
            box-shadow: var(--shadow-hover);
        }
        
        .schedule-count {
            background-color: white;
            color: var(--primary-color);
            font-size: 12px;
            padding: 4px 10px;
            border-radius: 15px;
            font-weight: 700;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* 核心筹备页面的保存按钮 */
        .save-button-container {
            margin-bottom: 20px;
            text-align: right;
        }
    </style>
</head>
<body>
    <!-- 头部 - 始终置顶 -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-heart"></i>
                <div>
                    <h1 contenteditable="true" id="mainTitle">婚礼筹备管家清单</h1>
                    <p>一站式婚礼筹备管理工具</p>
                </div>
                <span id="version">1.0 专业版</span>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" id="exportOptionsBtn">
                    <i class="fas fa-download"></i> 导出
                </button>
                <button class="btn btn-primary" id="addScheduleBtn">
                    <i class="fas fa-plus"></i> 添加档期
                </button>
            </div>
        </div>
    </header>
    
    <!-- 导航选项卡 -->
    <nav>
        <div class="container">
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="schedule">
                    <i class="fas fa-calendar-alt"></i> 管家档期
                </div>
                <div class="nav-tab" data-tab="client-details">
                    <i class="fas fa-users"></i> 客户详情
                </div>
                <div class="nav-tab" data-tab="preparation">
                    <i class="fas fa-tasks"></i> 核心筹备
                </div>
                <div class="nav-tab" data-tab="day-of">
                    <i class="fas fa-calendar-day"></i> 婚礼当天
                </div>
                <div class="nav-tab" data-tab="tools">
                    <i class="fas fa-tools"></i> 工具
                </div>
            </div>
        </div>
    </nav>
    
    <!-- 主要内容区域 -->
    <main class="container">
        <!-- 管家档期选项卡 - 首页 -->
        <div class="tab-content active" id="schedule">
            <div class="schedule-view-toggle">
                <div class="view-toggle-buttons">
                    <button class="view-toggle-btn active" id="calendarViewBtn">日历视图</button>
                    <button class="view-toggle-btn" id="listViewBtn">列表视图</button>
                    <button class="view-toggle-btn" id="statsViewBtn">统计视图</button>
                </div>
                <div class="btn-group" style="margin-left: auto; display: flex; gap: 10px;">
                    <button class="btn btn-secondary btn-small schedule-btn" id="thisMonthBtn">
                        <i class="fas fa-calendar-month"></i> 本月档期
                        <span class="schedule-count" id="thisMonthCount">0</span>
                    </button>
                    <button class="btn btn-secondary btn-small schedule-btn" id="fullYearBtn">
                        <i class="fas fa-calendar"></i> 全年档期
                        <span class="schedule-count" id="fullYearCount">0</span>
                    </button>
                    <button class="btn btn-secondary btn-small schedule-btn" id="monthlyIncomeBtn">
                        <i class="fas fa-money-bill-wave"></i> 本月收入
                        <span class="schedule-count" id="monthlyIncomeCount">¥0</span>
                    </button>
                </div>
                <button class="btn btn-primary btn-small" id="addEventBtn">
                    <i class="fas fa-plus"></i> 添加婚礼档期
                </button>
            </div>
            
            <!-- 统计图表容器 -->
            <div class="stats-chart-container" id="statsChartContainer">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chart-bar"></i> 往年档期统计</h2>
                </div>
                <div class="chart-container">
                    <canvas id="statsChart"></canvas>
                </div>
            </div>
            
            <!-- 日历视图 -->
            <div class="calendar-view active" id="calendarView">
                <div class="card">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" id="prevMonthBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div class="calendar-month" id="currentMonth">2023年10月</div>
                            <button class="calendar-nav-btn" id="nextMonthBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- 日历将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
            
            <!-- 列表视图 -->
            <div class="list-view" id="listView">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title"><i class="fas fa-list"></i> 档期列表</h2>
                    </div>
                    
                    <div id="scheduleList">
                        <!-- 列表将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 客户详情选项卡 -->
        <div class="tab-content" id="client-details">
            <!-- 客户管理系统 -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-users"></i> 客户管理</h2>
                    <div class="client-management-tools" style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="clientSearch" placeholder="搜索客户..." style="padding: 10px 15px; border: 1px solid var(--gray); border-radius: var(--border-radius); font-size: 14px; width: 250px;">
                        <button class="btn btn-primary btn-small" id="refreshClients">
                            <i class="fas fa-sync-alt"></i> 刷新
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="clientsTable" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background-color: var(--secondary-color);">
                                <th width="80" style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">状态</th>
                                <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">新人姓名</th>
                                <th width="150" style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">婚礼日期</th>
                                <th width="200" style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">婚礼酒店</th>
                                <th width="100" style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                            </tr>
                        </thead>
                        <tbody id="clientsTableBody">
                            <!-- 客户列表将动态生成 -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 客户详情 -->
            <div class="card" style="margin-top: 20px; box-shadow: var(--shadow);">
                <div class="client-info-header">
                    <div class="client-name" id="clientName">张三 & 李四 的婚礼</div>
                    <div class="client-wedding-date">
                        <i class="fas fa-calendar"></i>
                        <span id="clientWeddingDate">2023年11月18日</span>
                    </div>
                </div>
                
                <div class="client-info-grid">
                    <!-- 男方信息 -->
                    <div class="info-section groom-section">
                        <div class="info-label">
                            <i class="fas fa-male"></i> 新郎信息
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">姓名</div>
                            <div class="info-value editable" contenteditable="true" id="clientGroomName">张三</div>
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">电话</div>
                            <div class="info-value editable" contenteditable="true" id="clientGroomPhone">13800138000</div>
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">住址</div>
                            <div class="info-value editable" contenteditable="true" id="clientGroomAddress">北京市朝阳区XX街道</div>
                        </div>
                    </div>
                    
                    <!-- 女方信息 -->
                    <div class="info-section bride-section">
                        <div class="info-label">
                            <i class="fas fa-female"></i> 新娘信息
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">姓名</div>
                            <div class="info-value editable" contenteditable="true" id="clientBrideName">李四</div>
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">电话</div>
                            <div class="info-value editable" contenteditable="true" id="clientBridePhone">13900139000</div>
                        </div>
                        <div class="info-item">
                            <div class="info-sub-label">住址</div>
                            <div class="info-value editable" contenteditable="true" id="clientBrideAddress">上海市浦东新区XX路</div>
                        </div>
                    </div>
                    
                    <!-- 婚礼信息 -->
                    <div class="info-section wedding-section">
                        <div class="info-label">
                            <i class="fas fa-heart"></i> 婚礼信息
                        </div>
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-sub-label">婚礼酒店</div>
                                <div class="info-value editable" contenteditable="true" id="clientVenue">北京国际饭店</div>
                            </div>
                            <div class="info-item">
                                <div class="info-sub-label">酒店地址</div>
                                <div class="info-value editable" contenteditable="true" id="clientVenueAddress">北京市朝阳区建国门外大街1号</div>
                            </div>
                            <div class="info-item">
                                <div class="info-sub-label">服务费用</div>
                                <div class="info-value editable" contenteditable="true" id="clientFee">¥15,800</div>
                            </div>
                            <div class="info-item">
                                <div class="info-sub-label">婚礼主题</div>
                                <div class="info-value editable" contenteditable="true" id="clientTheme">浪漫花园主题</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 客户操作按钮 -->
                <div class="client-actions">
                    <button class="btn btn-primary" onclick="saveClientDetails()">
                        <i class="fas fa-save"></i> 保存客户信息
                    </button>
                    <button class="btn btn-secondary" onclick="addClient()">
                        <i class="fas fa-plus"></i> 添加新客户
                    </button>
                </div>
                
                <script>
                    // 为客户信息模块添加点击事件，跳转到客户详情顶部
                    document.addEventListener('DOMContentLoaded', function() {
                        const infoSections = document.querySelectorAll('.info-section');
                        const clientInfoHeader = document.querySelector('.client-info-header');
                        
                        infoSections.forEach(section => {
                            section.style.cursor = 'pointer';
                            section.addEventListener('click', function() {
                                clientInfoHeader.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            });
                        });
                    });
                </script>
                
                <!-- 快速导航按钮 -->
                <div class="quick-nav">
                    <div class="nav-card" onclick="jumpToSubtab('family-tasks')">
                        <i class="fas fa-home"></i>
                        <div class="nav-card-title">家庭责任清单</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('dowry')">
                        <i class="fas fa-gift"></i>
                        <div class="nav-card-title">新娘嫁妆清单</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('groom-supplies')">
                        <i class="fas fa-suitcase"></i>
                        <div class="nav-card-title">新郎物资清单</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('timeline')">
                        <i class="fas fa-calendar-alt"></i>
                        <div class="nav-card-title">备婚时间表</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('staff')">
                        <i class="fas fa-users-cog"></i>
                        <div class="nav-card-title">工作人员安排</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('vendors')">
                        <i class="fas fa-store"></i>
                        <div class="nav-card-title">供应商管理</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('budget')">
                        <i class="fas fa-money-bill-wave"></i>
                        <div class="nav-card-title">预算管理</div>
                    </div>
                    
                    <div class="nav-card" onclick="jumpToSubtab('checklist')">
                        <i class="fas fa-list-check"></i>
                        <div class="nav-card-title">最终检查清单</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 核心筹备选项卡 -->
        <div class="tab-content" id="preparation">

            
            <!-- 客户信息标题和保存按钮 -->
            <div class="card">
                <div class="save-button-container">
                    <button class="btn btn-primary" id="savePreparationBtn">
                        <i class="fas fa-save"></i> 保存当前进度
                    </button>
                </div>
                
                <div class="card-header">
                    <h2 class="card-title" id="preparationClientTitle"><i class="fas fa-heart"></i> 张三 & 李四 的婚礼 - 核心筹备</h2>
                </div>
                
                <!-- 进度条 -->
                <div class="progress-container" style="margin: 20px 0; padding: 25px; background-color: var(--light-color); border-radius: var(--border-radius);">
                    <div class="progress-header">
                        <h3 style="font-size: 18px; font-weight: 700; color: var(--dark-color);">筹备进度</h3>
                        <div class="progress-percent" id="progressPercent">30%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 30%;"></div>
                    </div>
                </div>
            </div>
            
            <!-- 子选项卡 -->
            <div class="sub-tabs">
                <div class="sub-tab active" data-subtab="family-tasks">家庭责任清单</div>
                <div class="sub-tab" data-subtab="dowry">新娘嫁妆清单</div>
                <div class="sub-tab" data-subtab="groom-supplies">新郎物资清单</div>
                <div class="sub-tab" data-subtab="timeline">备婚时间表</div>
                <div class="sub-tab" data-subtab="staff">工作人员安排</div>
                <div class="sub-tab" data-subtab="vendors">供应商管理</div>
                <div class="sub-tab" data-subtab="budget">预算管理</div>
                <div class="sub-tab" data-subtab="checklist">最终检查清单</div>
            </div>
            
            <!-- 子选项卡内容 -->
            <div class="sub-tab-content active" id="family-tasks">
                <div class="two-column-layout">
                    <!-- 男方家庭责任清单 -->
                    <div class="card">
                        <div class="card-header groom-section">
                            <h3 class="card-title"><i class="fas fa-male"></i> 男方家庭责任清单</h3>
                            <button class="btn btn-primary btn-small" onclick="addFamilyTask('groom')">
                                <i class="fas fa-plus"></i> 添加责任
                            </button>
                        </div>
                        <div id="groomFamilyTasksContent">
                            <!-- 男方家庭责任清单表格 -->
                            <table id="groomFamilyTasksTable" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">完成</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">责任内容</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">负责人</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">联系方式</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">备注</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="groomFamilyTasksTableBody">
                                    <!-- 男方示例数据 -->
                                    <tr>
                                        <td><input type="checkbox" class="status-checkbox" checked></td>
                                        <td contenteditable="true">预定婚礼酒店</td>
                                        <td contenteditable="true">张三父亲</td>
                                        <td contenteditable="true">13800138001</td>
                                        <td contenteditable="true">预算5万，已预定北京国际饭店</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteFamilyTask(this, 'groom')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" class="status-checkbox"></td>
                                        <td contenteditable="true">预订婚礼主持人</td>
                                        <td contenteditable="true">张三父亲</td>
                                        <td contenteditable="true">13800138001</td>
                                        <td contenteditable="true">预算4000元</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteFamilyTask(this, 'groom')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- 女方家庭责任清单 -->
                    <div class="card">
                        <div class="card-header bride-section">
                            <h3 class="card-title"><i class="fas fa-female"></i> 女方家庭责任清单</h3>
                            <button class="btn btn-primary btn-small" onclick="addFamilyTask('bride')">
                                <i class="fas fa-plus"></i> 添加责任
                            </button>
                        </div>
                        <div id="brideFamilyTasksContent">
                            <!-- 女方家庭责任清单表格 -->
                            <table id="brideFamilyTasksTable" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">完成</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">责任内容</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">负责人</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">联系方式</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="brideFamilyTasksTableBody">
                                    <!-- 女方示例数据 -->
                                    <tr>
                                        <td><input type="checkbox" class="status-checkbox" checked></td>
                                        <td contenteditable="true">确定婚礼日期</td>
                                        <td contenteditable="true">李四母亲</td>
                                        <td contenteditable="true">13900139001</td>
                                        <td contenteditable="true">已确定2023年11月18日</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteFamilyTask(this, 'bride')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" class="status-checkbox"></td>
                                        <td contenteditable="true">预订婚礼摄影摄像</td>
                                        <td contenteditable="true">李四母亲</td>
                                        <td contenteditable="true">13900139002</td>
                                        <td contenteditable="true">预算8000元</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteFamilyTask(this, 'bride')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="dowry">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-gift"></i> 新娘嫁妆清单</h3>
                        <button class="btn btn-primary btn-small" onclick="addDowryItem()">
                            <i class="fas fa-plus"></i> 添加嫁妆
                        </button>
                    </div>
                    <div id="dowryContent">
                        <!-- 新娘嫁妆清单表格 -->
                        <table id="dowryTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">完成</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">嫁妆物品</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">数量</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">价值</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                </tr>
                            </thead>
                            <tbody id="dowryTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox" checked></td>
                                    <td contenteditable="true">床上用品四件套</td>
                                    <td contenteditable="true">2套</td>
                                    <td contenteditable="true">¥2,000</td>
                                    <td contenteditable="true">红色和粉色</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">首饰</td>
                                    <td contenteditable="true">1套</td>
                                    <td contenteditable="true">¥50,000</td>
                                    <td contenteditable="true">包括项链、耳环、戒指</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">家电</td>
                                    <td contenteditable="true">1套</td>
                                    <td contenteditable="true">¥30,000</td>
                                    <td contenteditable="true">冰箱、洗衣机、电视</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">服装</td>
                                    <td contenteditable="true">10套</td>
                                    <td contenteditable="true">¥15,000</td>
                                    <td contenteditable="true">包括婚纱、敬酒服、回门服等</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">化妆品</td>
                                    <td contenteditable="true">1套</td>
                                    <td contenteditable="true">¥5,000</td>
                                    <td contenteditable="true">高端护肤品和彩妆</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">现金</td>
                                    <td contenteditable="true">1份</td>
                                    <td contenteditable="true">¥100,000</td>
                                    <td contenteditable="true">压箱底钱</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="groom-supplies">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-suitcase"></i> 新郎物资清单</h3>
                        <button class="btn btn-primary btn-small" onclick="addGroomSupply()">
                            <i class="fas fa-plus"></i> 添加物资
                        </button>
                    </div>
                    <div id="groomSuppliesContent">
                        <!-- 新郎物资清单表格 -->
                        <table id="groomSuppliesTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">完成</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">物资名称</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">数量</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">预算</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">购买地点</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                </tr>
                            </thead>
                            <tbody id="groomSuppliesTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox" checked></td>
                                    <td contenteditable="true">西装</td>
                                    <td contenteditable="true">1套</td>
                                    <td contenteditable="true">¥3,000</td>
                                    <td contenteditable="true">XX商场</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">衬衫</td>
                                    <td contenteditable="true">3件</td>
                                    <td contenteditable="true">¥1,000</td>
                                    <td contenteditable="true">网上购买</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">皮鞋</td>
                                    <td contenteditable="true">1双</td>
                                    <td contenteditable="true">¥800</td>
                                    <td contenteditable="true">XX鞋店</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">领带</td>
                                    <td contenteditable="true">2条</td>
                                    <td contenteditable="true">¥500</td>
                                    <td contenteditable="true">XX商场</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">袜子</td>
                                    <td contenteditable="true">10双</td>
                                    <td contenteditable="true">¥200</td>
                                    <td contenteditable="true">网上购买</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="status-checkbox"></td>
                                    <td contenteditable="true">手表</td>
                                    <td contenteditable="true">1块</td>
                                    <td contenteditable="true">¥10,000</td>
                                    <td contenteditable="true">XX专卖店</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="timeline">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-calendar-alt"></i> 备婚时间表</h3>
                        <button class="btn btn-primary btn-small" onclick="addTimelineItem()">
                            <i class="fas fa-plus"></i> 添加时间节点
                        </button>
                    </div>
                    <div id="timelineContent">
                        <!-- 备婚时间表 -->
                        <div class="timeline-container" id="timelineContainer">
                            <!-- 示例时间线数据 -->
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前6个月</div>
                                <div class="timeline-content">
                                    <h4>确定婚礼日期和地点</h4>
                                    <p>与双方父母商量确定婚礼日期，预定婚礼酒店和场地</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前4个月</div>
                                <div class="timeline-content">
                                    <h4>确定婚礼主题和风格</h4>
                                    <p>选择婚礼主题、色调和整体风格，开始准备婚礼策划</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前3个月</div>
                                <div class="timeline-content">
                                    <h4>预订婚礼服务团队</h4>
                                    <p>预订摄影师、摄像师、化妆师、主持人等服务团队</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前2个月</div>
                                <div class="timeline-content">
                                    <h4>准备婚纱礼服</h4>
                                    <p>购买或租赁婚纱、西装，开始试穿和修改</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前1个月</div>
                                <div class="timeline-content">
                                    <h4>发送婚礼请柬</h4>
                                    <p>确定婚礼嘉宾名单，发送电子或纸质请柬</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前2周</div>
                                <div class="timeline-content">
                                    <h4>确认所有预订</h4>
                                    <p>与酒店、服务团队、供应商确认最终细节</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前1周</div>
                                <div class="timeline-content">
                                    <h4>最终准备</h4>
                                    <p>确认所有细节，准备婚礼所需物品，进行彩排</p>
                                </div>
                            </div>
                            <div class="timeline-item" contenteditable="true">
                                <div class="timeline-time">婚礼前1天</div>
                                <div class="timeline-content">
                                    <h4>最后的准备工作</h4>
                                    <p>布置新房，准备迎亲物品，确认所有物品都已准备好</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="staff">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-users-cog"></i> 工作人员安排</h3>
                        <button class="btn btn-primary btn-small" onclick="addStaffMember()">
                            <i class="fas fa-plus"></i> 添加工作人员
                        </button>
                    </div>
                    <div id="staffContent">
                        <!-- 工作人员安排表格 -->
                        <table id="staffTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">姓名</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">职位</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">联系方式</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">职责描述</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">费用</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                </tr>
                            </thead>
                            <tbody id="staffTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td contenteditable="true">张摄影</td>
                                    <td contenteditable="true">摄影师</td>
                                    <td contenteditable="true">13800138002</td>
                                    <td contenteditable="true">负责婚礼全程摄影</td>
                                    <td contenteditable="true">¥5,000</td>
                                    <td contenteditable="true">包含精修照片和相册</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">李化妆</td>
                                    <td contenteditable="true">化妆师</td>
                                    <td contenteditable="true">13900139002</td>
                                    <td contenteditable="true">负责新娘和伴娘化妆</td>
                                    <td contenteditable="true">¥3,000</td>
                                    <td contenteditable="true">包含试妆服务</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">王主持</td>
                                    <td contenteditable="true">主持人</td>
                                    <td contenteditable="true">13700137001</td>
                                    <td contenteditable="true">负责婚礼现场主持</td>
                                    <td contenteditable="true">¥4,000</td>
                                    <td contenteditable="true">包含前期沟通和策划</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">赵摄像</td>
                                    <td contenteditable="true">摄像师</td>
                                    <td contenteditable="true">13600136001</td>
                                    <td contenteditable="true">负责婚礼全程摄像</td>
                                    <td contenteditable="true">¥6,000</td>
                                    <td contenteditable="true">包含婚礼视频和MV制作</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">钱督导</td>
                                    <td contenteditable="true">婚礼督导</td>
                                    <td contenteditable="true">13500135001</td>
                                    <td contenteditable="true">负责婚礼现场协调和执行</td>
                                    <td contenteditable="true">¥2,000</td>
                                    <td contenteditable="true">包含前期沟通和彩排</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">孙花艺</td>
                                    <td contenteditable="true">花艺师</td>
                                    <td contenteditable="true">13400134001</td>
                                    <td contenteditable="true">负责婚礼现场花艺布置</td>
                                    <td contenteditable="true">¥8,000</td>
                                    <td contenteditable="true">包含鲜花和布置材料</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="vendors">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-store"></i> 供应商管理</h3>
                        <button class="btn btn-primary btn-small" onclick="addVendor()">
                            <i class="fas fa-plus"></i> 添加供应商
                        </button>
                    </div>
                    <div id="vendorsContent">
                        <!-- 供应商管理表格 -->
                        <table id="vendorsTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">供应商名称</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">联系人</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">联系方式</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">提供服务</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">费用</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">地址</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                </tr>
                            </thead>
                            <tbody id="vendorsTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td contenteditable="true">XX婚礼策划公司</td>
                                    <td contenteditable="true">李策划</td>
                                    <td contenteditable="true">13800138003</td>
                                    <td contenteditable="true">婚礼策划</td>
                                    <td contenteditable="true">¥15,000</td>
                                    <td contenteditable="true">北京市朝阳区XX路</td>
                                    <td contenteditable="true">包含场地布置和流程设计</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">XX鲜花店</td>
                                    <td contenteditable="true">王花艺</td>
                                    <td contenteditable="true">13900139003</td>
                                    <td contenteditable="true">婚礼鲜花</td>
                                    <td contenteditable="true">¥8,000</td>
                                    <td contenteditable="true">上海市浦东新区XX路</td>
                                    <td contenteditable="true">包含新娘手捧花、胸花和场地花艺</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">XX音响租赁公司</td>
                                    <td contenteditable="true">赵音响</td>
                                    <td contenteditable="true">13700137002</td>
                                    <td contenteditable="true">音响设备租赁</td>
                                    <td contenteditable="true">¥3,000</td>
                                    <td contenteditable="true">广州市天河区XX路</td>
                                    <td contenteditable="true">包含音响、麦克风和调音师</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">XX婚纱租赁店</td>
                                    <td contenteditable="true">周婚纱</td>
                                    <td contenteditable="true">13600136002</td>
                                    <td contenteditable="true">婚纱礼服租赁</td>
                                    <td contenteditable="true">¥5,000</td>
                                    <td contenteditable="true">深圳市南山区XX路</td>
                                    <td contenteditable="true">包含婚纱、敬酒服和伴娘服</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">XX蛋糕店</td>
                                    <td contenteditable="true">吴蛋糕</td>
                                    <td contenteditable="true">13500135002</td>
                                    <td contenteditable="true">婚礼蛋糕</td>
                                    <td contenteditable="true">¥3,500</td>
                                    <td contenteditable="true">杭州市西湖区XX路</td>
                                    <td contenteditable="true">包含婚礼蛋糕和甜品台</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">XX婚车租赁公司</td>
                                    <td contenteditable="true">郑婚车</td>
                                    <td contenteditable="true">13400134002</td>
                                    <td contenteditable="true">婚车租赁</td>
                                    <td contenteditable="true">¥4,000</td>
                                    <td contenteditable="true">成都市锦江区XX路</td>
                                    <td contenteditable="true">包含主婚车和车队</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="budget">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-money-bill-wave"></i> 预算管理</h3>
                        <button class="btn btn-primary btn-small" onclick="addBudgetItem()">
                            <i class="fas fa-plus"></i> 添加预算项目
                        </button>
                    </div>
                    <div id="budgetContent">
                        <!-- 预算管理表格 -->
                        <table id="budgetTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">项目类别</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">项目名称</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">预算金额</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">实际支出</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">差额</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                </tr>
                            </thead>
                            <tbody id="budgetTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td contenteditable="true">场地费用</td>
                                    <td contenteditable="true">婚礼酒店</td>
                                    <td contenteditable="true">¥50,000</td>
                                    <td contenteditable="true">¥48,000</td>
                                    <td style="color: var(--success-color); font-weight: 600;">¥-2,000</td>
                                    <td contenteditable="true">包含场地租赁和餐饮</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteBudgetItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">服务费用</td>
                                    <td contenteditable="true">婚礼策划</td>
                                    <td contenteditable="true">¥15,000</td>
                                    <td contenteditable="true">¥15,000</td>
                                    <td style="color: var(--info-color); font-weight: 600;">¥0</td>
                                    <td contenteditable="true">包含场地布置和流程设计</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteBudgetItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">服务费用</td>
                                    <td contenteditable="true">摄影摄像</td>
                                    <td contenteditable="true">¥8,000</td>
                                    <td contenteditable="true">¥9,000</td>
                                    <td style="color: var(--primary-color); font-weight: 600;">¥1,000</td>
                                    <td contenteditable="true">加了额外的航拍服务</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteBudgetItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">物资费用</td>
                                    <td contenteditable="true">婚纱礼服</td>
                                    <td contenteditable="true">¥10,000</td>
                                    <td contenteditable="true">¥8,500</td>
                                    <td style="color: var(--success-color); font-weight: 600;">¥-1,500</td>
                                    <td contenteditable="true">婚纱租赁，西装购买</td>
                                    <td>
                                        <button class="btn btn-secondary btn-small" onclick="deleteBudgetItem(this)">
                                            <i class="fas fa-trash"></i> 删除
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <!-- 预算汇总 -->
                        <div style="margin-top: 20px; padding: 20px; background-color: var(--light-color); border-radius: var(--border-radius);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="font-weight: 700; color: var(--dark-color);">总预算：</span>
                                <span id="totalBudget" style="font-weight: 700; color: var(--dark-color);">¥83,000</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="font-weight: 700; color: var(--dark-color);">实际支出：</span>
                                <span id="totalActual" style="font-weight: 700; color: var(--primary-color);">¥80,500</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 700; color: var(--dark-color);">总差额：</span>
                                <span id="totalDifference" style="font-weight: 700; color: var(--success-color);">¥-2,500</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="sub-tab-content" id="checklist">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-list-check"></i> 最终检查清单</h3>
                        <button class="btn btn-primary btn-small" onclick="addChecklistItem()">
                            <i class="fas fa-plus"></i> 添加检查项目
                        </button>
                    </div>
                    <div id="checklistContent">
                        <!-- 最终检查清单 -->
                        <div class="two-column-layout">
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--dark-color); font-size: 18px;">婚礼前一周</h4>
                                <div class="checklist-section" id="checklistWeekBefore">
                                    <!-- 婚礼前一周检查项目 -->
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">确认所有供应商的时间和地点</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">试穿婚纱、西装，确保合身</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">确认婚礼流程和主持人脚本</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">准备好婚戒、誓言卡等重要物品</div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 15px; color: var(--dark-color); font-size: 18px;">婚礼前一天</h4>
                                <div class="checklist-section" id="checklistDayBefore">
                                    <!-- 婚礼前一天检查项目 -->
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">布置新房，准备好迎亲物品</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">确认摄影、摄像、化妆时间和地点</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">准备好红包和伴郎伴娘礼物</div>
                                    </div>
                                    <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                        <input type="checkbox" class="status-checkbox">
                                        <div style="flex: 1;" contenteditable="true">早点休息，保持良好状态</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h4 style="margin-bottom: 15px; color: var(--dark-color); font-size: 18px;">婚礼当天</h4>
                            <div class="checklist-section" id="checklistDayOf">
                                <!-- 婚礼当天检查项目 -->
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                    <input type="checkbox" class="status-checkbox">
                                    <div style="flex: 1;" contenteditable="true">早起，吃好早餐</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                    <input type="checkbox" class="status-checkbox">
                                    <div style="flex: 1;" contenteditable="true">确认所有物品都已准备好</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; padding: 10px; background-color: var(--light-color); border-radius: var(--border-radius);">
                                    <input type="checkbox" class="status-checkbox">
                                    <div style="flex: 1;" contenteditable="true">保持放松，享受婚礼时光</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 婚礼当天选项卡 -->
        <div class="tab-content" id="day-of">
            <div class="card">
                <div class="save-button-container">
                    <button class="btn btn-primary" id="saveDayOfBtn">
                        <i class="fas fa-save"></i> 保存婚礼当天进度
                    </button>
                </div>
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-calendar-day"></i> 婚礼当天</h2>
                </div>
                <div id="dayOfContent">
                    <!-- 男女方同时进行的婚礼当天流程 -->
                    <div class="two-column-layout">
                        <!-- 男方流程 -->
                        <div class="card">
                            <div class="card-header groom-section">
                                <h3 class="card-title"><i class="fas fa-male"></i> 男方当天流程</h3>
                                <button class="btn btn-primary btn-small" onclick="addDayOfItem('groom')">
                                    <i class="fas fa-plus"></i> 添加流程节点
                                </button>
                            </div>
                            <div style="margin: 20px;">
                                <table id="groomDayOfScheduleTable" style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">时间</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">环节</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">地点</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">负责人</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">备注</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--info-color);">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="groomDayOfScheduleTableBody">
                                        <!-- 男方示例数据 -->
                                        <tr>
                                            <td contenteditable="true">07:00</td>
                                            <td contenteditable="true">新郎起床、洗漱</td>
                                            <td contenteditable="true">新郎家</td>
                                            <td contenteditable="true">伴郎</td>
                                            <td contenteditable="true">准备接亲</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'groom')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td contenteditable="true">08:00</td>
                                            <td contenteditable="true">新郎接亲</td>
                                            <td contenteditable="true">新娘家</td>
                                            <td contenteditable="true">伴郎团</td>
                                            <td contenteditable="true">准备接亲游戏和红包</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'groom')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td contenteditable="true">09:30</td>
                                            <td contenteditable="true">敬茶仪式</td>
                                            <td contenteditable="true">新娘家</td>
                                            <td contenteditable="true">新郎、伴郎</td>
                                            <td contenteditable="true">准备敬茶用具和红包</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'groom')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 女方流程 -->
                        <div class="card">
                            <div class="card-header bride-section">
                                <h3 class="card-title"><i class="fas fa-female"></i> 女方当天流程</h3>
                                <button class="btn btn-primary btn-small" onclick="addDayOfItem('bride')">
                                    <i class="fas fa-plus"></i> 添加流程节点
                                </button>
                            </div>
                            <div style="margin: 20px;">
                                <table id="brideDayOfScheduleTable" style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">时间</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">环节</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">地点</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">负责人</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                            <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="brideDayOfScheduleTableBody">
                                        <!-- 女方示例数据 -->
                                        <tr>
                                            <td contenteditable="true">07:00</td>
                                            <td contenteditable="true">新娘化妆</td>
                                            <td contenteditable="true">新娘家</td>
                                            <td contenteditable="true">化妆师</td>
                                            <td contenteditable="true">包含发型和妆容</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'bride')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td contenteditable="true">08:30</td>
                                            <td contenteditable="true">新娘换婚纱</td>
                                            <td contenteditable="true">新娘家</td>
                                            <td contenteditable="true">伴娘</td>
                                            <td contenteditable="true">准备迎接新郎</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'bride')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td contenteditable="true">09:30</td>
                                            <td contenteditable="true">敬茶仪式</td>
                                            <td contenteditable="true">新娘家</td>
                                            <td contenteditable="true">新娘、伴娘</td>
                                            <td contenteditable="true">准备敬茶用具和红包</td>
                                            <td>
                                                <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'bride')">
                                                    <i class="fas fa-trash"></i> 删除
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 共同流程 -->
                    <div class="card" style="margin-top: 30px;">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-heart"></i> 共同流程</h3>
                            <button class="btn btn-primary btn-small" onclick="addDayOfItem('common')">
                                <i class="fas fa-plus"></i> 添加流程节点
                            </button>
                        </div>
                        <div style="margin: 20px;">
                            <table id="commonDayOfScheduleTable" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">时间</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">环节</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">地点</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">负责人</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">备注</th>
                                        <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--success-color);">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="commonDayOfScheduleTableBody">
                                    <!-- 共同流程示例数据 -->
                                    <tr>
                                        <td contenteditable="true">10:00</td>
                                        <td contenteditable="true">前往婚礼酒店</td>
                                        <td contenteditable="true">路上</td>
                                        <td contenteditable="true">司机</td>
                                        <td contenteditable="true">注意交通安全</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true">10:30</td>
                                        <td contenteditable="true">新人迎宾</td>
                                        <td contenteditable="true">婚礼现场</td>
                                        <td contenteditable="true">新人</td>
                                        <td contenteditable="true">准备迎宾牌和签到簿</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true">11:30</td>
                                        <td contenteditable="true">婚礼仪式开始</td>
                                        <td contenteditable="true">婚礼现场</td>
                                        <td contenteditable="true">主持人</td>
                                        <td contenteditable="true">准备好戒指和誓言卡</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true">12:30</td>
                                        <td contenteditable="true">婚宴开始</td>
                                        <td contenteditable="true">婚礼现场</td>
                                        <td contenteditable="true">酒店服务人员</td>
                                        <td contenteditable="true">准备敬酒</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true">13:00</td>
                                        <td contenteditable="true">新人敬酒</td>
                                        <td contenteditable="true">婚礼现场</td>
                                        <td contenteditable="true">新人</td>
                                        <td contenteditable="true">准备敬酒道具和红包</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true">14:30</td>
                                        <td contenteditable="true">婚宴结束</td>
                                        <td contenteditable="true">婚礼现场</td>
                                        <td contenteditable="true">酒店服务人员</td>
                                        <td contenteditable="true">准备送客</td>
                                        <td>
                                            <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, 'common')">
                                                <i class="fas fa-trash"></i> 删除
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- 婚礼当天人员分工 -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="margin-bottom: 15px; color: var(--dark-color); font-size: 20px;">当天人员分工</h3>
                        <table id="dayOfStaffTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">姓名</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">职位</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">主要职责</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">联系方式</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: var(--dark-color); border-bottom: 2px solid var(--primary-color);">备注</th>
                                </tr>
                            </thead>
                            <tbody id="dayOfStaffTableBody">
                                <!-- 示例数据 -->
                                <tr>
                                    <td contenteditable="true">主持人</td>
                                    <td contenteditable="true">婚礼主持</td>
                                    <td contenteditable="true">把控整个婚礼流程</td>
                                    <td contenteditable="true">13700137001</td>
                                    <td contenteditable="true">提前1小时到场</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">摄影师</td>
                                    <td contenteditable="true">婚礼摄影</td>
                                    <td contenteditable="true">全程拍摄婚礼照片</td>
                                    <td contenteditable="true">13800138002</td>
                                    <td contenteditable="true">提前1小时到场</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">摄像师</td>
                                    <td contenteditable="true">婚礼摄像</td>
                                    <td contenteditable="true">全程拍摄婚礼视频</td>
                                    <td contenteditable="true">13900139002</td>
                                    <td contenteditable="true">提前1小时到场</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">化妆师</td>
                                    <td contenteditable="true">新娘化妆</td>
                                    <td contenteditable="true">新娘和伴娘的妆容和发型</td>
                                    <td contenteditable="true">13700137002</td>
                                    <td contenteditable="true">提前2小时到场</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 婚礼当天物品清单 -->
                    <div>
                        <h3 style="margin-bottom: 15px; color: var(--dark-color); font-size: 20px;">当天物品清单</h3>
                        <div id="dayOfItemsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                            <!-- 示例数据 -->
                            <div class="checklist-section" style="background-color: var(--light-color); padding: 20px; border-radius: var(--border-radius);">
                                <h4 style="margin-bottom: 15px; color: var(--dark-color); font-size: 16px;">新人必备物品</h4>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">婚戒</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">誓言卡</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">身份证</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">红包</div>
                                </div>
                            </div>
                            
                            <div class="checklist-section" style="background-color: var(--light-color); padding: 20px; border-radius: var(--border-radius);">
                                <h4 style="margin-bottom: 15px; color: var(--dark-color); font-size: 16px;">现场布置物品</h4>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">鲜花</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">气球</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">蜡烛</div>
                                </div>
                                <div class="checklist-item" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <input type="checkbox" class="status-checkbox">
                                    <div contenteditable="true">音响设备</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 工具选项卡 -->
        <div class="tab-content" id="tools">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-tools"></i> 工具</h2>
                </div>
                <div id="toolsContent">
                    <!-- 倒计时计算器 -->
                    <div class="two-column-layout" style="margin-bottom: 30px;">
                        <div style="background-color: var(--light-color); padding: 25px; border-radius: var(--border-radius);">
                            <h3 style="margin-bottom: 20px; color: var(--dark-color); font-size: 18px;"><i class="fas fa-clock"></i> 婚礼倒计时</h3>
                            <div style="margin-bottom: 20px;">
                                <label for="weddingDateInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark-color);">婚礼日期</label>
                                <input type="date" id="weddingDateInput" style="width: 100%; padding: 12px 15px; border: 1px solid var(--gray); border-radius: var(--border-radius); font-size: 16px;">
                            </div>
                            <div id="countdownResult" style="text-align: center; padding: 20px; background-color: white; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <div style="font-size: 36px; font-weight: 700; color: var(--primary-color); margin-bottom: 10px;">0</div>
                                <div style="color: var(--dark-color);">天</div>
                            </div>
                        </div>
                        
                        <!-- 预算计算器 -->
                        <div style="background-color: var(--light-color); padding: 25px; border-radius: var(--border-radius);">
                            <h3 style="margin-bottom: 20px; color: var(--dark-color); font-size: 18px;"><i class="fas fa-calculator"></i> 预算计算器</h3>
                            <div style="margin-bottom: 15px;">
                                <label for="totalBudgetInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark-color);">总预算</label>
                                <input type="number" id="totalBudgetInput" placeholder="输入总预算金额" style="width: 100%; padding: 12px 15px; border: 1px solid var(--gray); border-radius: var(--border-radius); font-size: 16px;">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label for="expensesInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark-color);">已支出</label>
                                <input type="number" id="expensesInput" placeholder="输入已支出金额" style="width: 100%; padding: 12px 15px; border: 1px solid var(--gray); border-radius: var(--border-radius); font-size: 16px;">
                            </div>
                            <button id="calculateBudgetBtn" class="btn btn-primary" style="width: 100%; margin-bottom: 15px;">计算剩余预算</button>
                            <div id="budgetResult" style="text-align: center; padding: 20px; background-color: white; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <div style="font-size: 24px; font-weight: 700; color: var(--success-color); margin-bottom: 5px;">剩余预算：¥0</div>
                                <div style="color: var(--dark-color); font-size: 14px;">占总预算的 0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 常用联系人 -->
                    <div style="background-color: var(--light-color); padding: 25px; border-radius: var(--border-radius); margin-bottom: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin-bottom: 0; color: var(--dark-color); font-size: 18px;"><i class="fas fa-address-book"></i> 常用联系人</h3>
                            <button class="btn btn-primary btn-small" onclick="addContact()">
                                <i class="fas fa-plus"></i> 添加联系人
                            </button>
                        </div>
                        <div id="contactsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
                            <!-- 示例联系人 -->
                            <div class="contact-item" style="background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <div style="font-weight: 700; color: var(--dark-color); margin-bottom: 5px;" contenteditable="true">张摄影</div>
                                <div style="color: var(--gray-dark); margin-bottom: 5px;" contenteditable="true">摄影师</div>
                                <div style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;" contenteditable="true">13800138002</div>
                                <button class="btn btn-secondary btn-small" onclick="deleteContact(this)">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                            <div class="contact-item" style="background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <div style="font-weight: 700; color: var(--dark-color); margin-bottom: 5px;" contenteditable="true">李化妆</div>
                                <div style="color: var(--gray-dark); margin-bottom: 5px;" contenteditable="true">化妆师</div>
                                <div style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;" contenteditable="true">13900139002</div>
                                <button class="btn btn-secondary btn-small" onclick="deleteContact(this)">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                            <div class="contact-item" style="background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <div style="font-weight: 700; color: var(--dark-color); margin-bottom: 5px;" contenteditable="true">王主持</div>
                                <div style="color: var(--gray-dark); margin-bottom: 5px;" contenteditable="true">主持人</div>
                                <div style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;" contenteditable="true">13700137001</div>
                                <button class="btn btn-secondary btn-small" onclick="deleteContact(this)">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 婚礼小知识 -->
                    <div style="background-color: var(--light-color); padding: 25px; border-radius: var(--border-radius);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin-bottom: 0; color: var(--dark-color); font-size: 18px;"><i class="fas fa-lightbulb"></i> 婚礼小知识</h3>
                            <button class="btn btn-primary btn-small" onclick="addWeddingTip()">
                                <i class="fas fa-plus"></i> 添加小知识
                            </button>
                        </div>
                        <div id="weddingTips" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                            <!-- 示例小知识 -->
                            <div class="tip-item" style="background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <h4 style="margin-bottom: 10px; color: var(--dark-color); font-size: 16px;" contenteditable="true">婚礼前注意事项</h4>
                                <p style="color: var(--gray-dark); font-size: 14px; line-height: 1.6; margin-bottom: 10px;" contenteditable="true">婚礼前一周要注意饮食清淡，保证充足的睡眠，避免熬夜和过度劳累。提前准备好所有需要携带的物品，列一个详细的清单，以免遗漏。</p>
                                <button class="btn btn-secondary btn-small" onclick="deleteWeddingTip(this)">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                            <div class="tip-item" style="background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
                                <h4 style="margin-bottom: 10px; color: var(--dark-color); font-size: 16px;" contenteditable="true">婚礼当天流程建议</h4>
                                <p style="color: var(--gray-dark); font-size: 14px; line-height: 1.6; margin-bottom: 10px;" contenteditable="true">婚礼当天建议提前1-2小时到达现场，与各服务团队进行最后的确认。保持放松的心态，享受这个特殊的日子，不要过于紧张细节。</p>
                                <button class="btn btn-secondary btn-small" onclick="deleteWeddingTip(this)">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- 页脚 -->
    <footer>
        <div class="container">
            <p>&copy; 2026 婚礼筹备管家清单 1.0 专业版 - 一站式婚礼筹备管理工具</p>
        </div>
    </footer>
    
    <!-- 导出选项模态框 -->
    <div class="modal" id="exportOptionsModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 class="modal-title"><i class="fas fa-download"></i> 导出选项</h3>
            <div class="export-options">
                <div class="export-option" id="exportImageBtn">
                    <i class="fas fa-image"></i>
                    <div class="export-option-title">导出当前页截图</div>
                </div>
                <div class="export-option" id="exportClientExcelBtn">
                    <i class="fas fa-file-excel"></i>
                    <div class="export-option-title">导出当前客户Excel表格</div>
                </div>
                <div class="export-option" id="exportAllClientsExcelBtn">
                    <i class="fas fa-file-excel"></i>
                    <div class="export-option-title">导出所有客户Excel表格</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 添加档期模态框 -->
    <div class="modal" id="addScheduleModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h3 class="modal-title"><i class="fas fa-plus"></i> 添加婚礼档期</h3>
            <form id="addScheduleForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="groomName">新郎姓名</label>
                        <input type="text" id="groomName" name="groomName" required>
                    </div>
                    <div class="form-group">
                        <label for="brideName">新娘姓名</label>
                        <input type="text" id="brideName" name="brideName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="weddingDate">婚礼日期</label>
                    <input type="date" id="weddingDate" name="weddingDate" required>
                </div>
                <div class="form-group">
                    <label for="venue">婚礼酒店</label>
                    <input type="text" id="venue" name="venue" required>
                </div>
                <div class="form-group">
                    <label for="venueAddress">酒店地址</label>
                    <textarea id="venueAddress" name="venueAddress" rows="3"></textarea>
                </div>
                <div class="action-buttons">
                    <button type="button" class="btn btn-secondary" id="cancelAddSchedule">取消</button>
                    <button type="submit" class="btn btn-primary">添加档期</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // 全局数据
        let currentClientId = null;
        let currentClient = null;
        let currentDate = new Date();
        let currentView = 'calendar';
        
        // 数据结构
        let clients = [];
        let schedules = [];
        

        

        
        // 保存到本地存储
        function saveToLocalStorage() {
            localStorage.setItem('weddingPlannerClients', JSON.stringify(clients));
            localStorage.setItem('weddingPlannerSchedules', JSON.stringify(schedules));
            localStorage.setItem('weddingPlannerLastUpdated', lastLocalUpdate.toString());
        }
        
        // 从本地存储加载数据
        function loadFromLocalStorage() {
            const savedClients = localStorage.getItem('weddingPlannerClients');
            const savedSchedules = localStorage.getItem('weddingPlannerSchedules');
            const savedLastUpdated = localStorage.getItem('weddingPlannerLastUpdated');
            
            if (savedClients) {
                clients = JSON.parse(savedClients);
            }
            
            if (savedSchedules) {
                schedules = JSON.parse(savedSchedules);
            }
            
            if (savedLastUpdated) {
                lastLocalUpdate = parseInt(savedLastUpdated);
            }
        }
        
        // 数据变更时自动同步到本地存储
        function onDataChanged() {
            saveToLocalStorage();
        }
        

        
        // 初始化数据
        function initData() {
            // 从localStorage加载数据
            loadFromLocalStorage();
            
            if (clients.length === 0) {
                // 初始化示例数据
                clients = [
                    {
                        id: '1',
                        groomName: '张三',
                        brideName: '李四',
                        weddingDate: '2023-11-18',
                        venue: '北京国际饭店',
                        venueAddress: '北京市朝阳区建国门外大街1号',
                        status: 'green',
                        groomPhone: '13800138000',
                        groomAddress: '北京市朝阳区XX街道',
                        bridePhone: '13900139000',
                        brideAddress: '上海市浦东新区XX路',
                        fee: '¥15,800',
                        theme: '浪漫花园主题'
                    },
                    {
                        id: '2',
                        groomName: '王五',
                        brideName: '赵六',
                        weddingDate: '2023-12-25',
                        venue: '上海外滩华尔道夫酒店',
                        venueAddress: '上海市黄浦区中山东一路2号',
                        status: 'yellow',
                        groomPhone: '13700137000',
                        groomAddress: '上海市静安区XX路',
                        bridePhone: '13600136000',
                        brideAddress: '杭州市西湖区XX路',
                        fee: '¥25,800',
                        theme: '复古宫廷主题'
                    },
                    {
                        id: '3',
                        groomName: '孙七',
                        brideName: '周八',
                        weddingDate: '2024-01-15',
                        venue: '广州四季酒店',
                        venueAddress: '广州市天河区珠江新城珠江西路5号',
                        status: 'green',
                        groomPhone: '13500135000',
                        groomAddress: '广州市天河区XX路',
                        bridePhone: '13400134000',
                        brideAddress: '深圳市南山区XX路',
                        fee: '¥18,800',
                        theme: '现代简约主题'
                    },
                    {
                        id: '4',
                        groomName: '吴九',
                        brideName: '郑十',
                        weddingDate: '2024-02-14',
                        venue: '深圳前海JW万豪酒店',
                        venueAddress: '深圳市南山区宝兴路8号',
                        status: 'red',
                        groomPhone: '13300133000',
                        groomAddress: '深圳市福田区XX路',
                        bridePhone: '13200132000',
                        brideAddress: '成都市锦江区XX路',
                        fee: '¥22,800',
                        theme: '森系自然主题'
                    },
                    {
                        id: '5',
                        groomName: '陈十一',
                        brideName: '刘十二',
                        weddingDate: '2024-03-08',
                        venue: '成都丽思卡尔顿酒店',
                        venueAddress: '成都市锦江区顺城大街269号',
                        status: 'green',
                        groomPhone: '13100131000',
                        groomAddress: '成都市武侯区XX路',
                        bridePhone: '13000130000',
                        brideAddress: '武汉市江汉区XX路',
                        fee: '¥16,800',
                        theme: '中式传统主题'
                    }
                ];
            }
            
            if (schedules.length === 0) {
                // 初始化示例数据
                schedules = [
                    {
                        id: '1',
                        groomName: '张三',
                        brideName: '李四',
                        weddingDate: '2023-11-18',
                        venue: '北京国际饭店'
                    }
                ];
            }
            
            // 设置默认客户
            if (clients.length > 0) {
                currentClientId = clients[0].id;
                currentClient = clients[0];
            }
        }
        
        // 保存数据到localStorage
        function saveData() {
            localStorage.setItem('weddingPlannerClients', JSON.stringify(clients));
            localStorage.setItem('weddingPlannerSchedules', JSON.stringify(schedules));
            // 同步数据到Firebase
            saveDataToFirebase();
        }
        
        // 加载保存的数据
        function loadSavedData() {
            initData();
            renderAllTables();
            updateClientDetails();
            updatePreparationClientTitle();
        }
        
        // 渲染所有表格
        function renderAllTables() {
            renderClientsTable();
            renderCalendar();
            renderScheduleList();
        }
        
        // 切换选项卡
        window.switchTab = function(tabName) {
            // 移除所有选项卡的active类
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 隐藏所有选项卡内容
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // 激活当前选项卡
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // 切换子选项卡
        window.switchSubTab = function(subtabName) {
            // 移除所有子选项卡的active类
            document.querySelectorAll('.sub-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 隐藏所有子选项卡内容
            document.querySelectorAll('.sub-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // 激活当前子选项卡
            document.querySelector(`[data-subtab="${subtabName}"]`).classList.add('active');
            document.getElementById(subtabName).classList.add('active');
        }
        
        // 跳转到指定子选项卡并滚动到顶部
        window.jumpToSubtab = function(subtabName) {
            // 检查当前是否已经在核心筹备选项卡
            const currentTab = document.querySelector('.nav-tab.active').getAttribute('data-tab');
            if (currentTab !== 'preparation') {
                // 切换到核心筹备选项卡
                window.switchTab('preparation');
            }
            // 切换到指定的子选项卡
            window.switchSubTab(subtabName);
            // 滚动到子选项卡内容顶部
            document.getElementById(subtabName).scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // 更新客户详情
        function updateClientDetails() {
            if (!currentClient) return;
            
            document.getElementById('clientName').textContent = `${currentClient.groomName} & ${currentClient.brideName} 的婚礼`;
            document.getElementById('clientWeddingDate').textContent = formatDate(currentClient.weddingDate);
            document.getElementById('clientGroomName').textContent = currentClient.groomName;
            document.getElementById('clientGroomPhone').textContent = currentClient.groomPhone || '';
            document.getElementById('clientGroomAddress').textContent = currentClient.groomAddress || '';
            document.getElementById('clientBrideName').textContent = currentClient.brideName;
            document.getElementById('clientBridePhone').textContent = currentClient.bridePhone || '';
            document.getElementById('clientBrideAddress').textContent = currentClient.brideAddress || '';
            document.getElementById('clientVenue').textContent = currentClient.venue || '';
            document.getElementById('clientVenueAddress').textContent = currentClient.venueAddress || '';
            document.getElementById('clientFee').textContent = currentClient.fee || '';
            document.getElementById('clientTheme').textContent = currentClient.theme || '';
        }
        
        // 保存客户详情
        function saveClientDetails() {
            if (!currentClient) return;
            
            // 更新当前客户对象
            currentClient.groomName = document.getElementById('clientGroomName').textContent;
            currentClient.brideName = document.getElementById('clientBrideName').textContent;
            currentClient.groomPhone = document.getElementById('clientGroomPhone').textContent;
            currentClient.groomAddress = document.getElementById('clientGroomAddress').textContent;
            currentClient.bridePhone = document.getElementById('clientBridePhone').textContent;
            currentClient.brideAddress = document.getElementById('clientBrideAddress').textContent;
            currentClient.venue = document.getElementById('clientVenue').textContent;
            currentClient.venueAddress = document.getElementById('clientVenueAddress').textContent;
            currentClient.fee = document.getElementById('clientFee').textContent;
            currentClient.theme = document.getElementById('clientTheme').textContent;
            
            // 更新客户名称显示
            document.getElementById('clientName').textContent = `${currentClient.groomName} & ${currentClient.brideName} 的婚礼`;
            
            // 更新核心筹备页面的客户标题
            updatePreparationClientTitle();
            
            // 保存到localStorage
            saveData();
            
            alert('客户信息已保存！');
        }
        
        // 更新核心筹备页面的客户标题
        function updatePreparationClientTitle() {
            if (!currentClient) return;
            document.getElementById('preparationClientTitle').innerHTML = `<i class="fas fa-heart"></i> ${currentClient.groomName} & ${currentClient.brideName} 的婚礼 - 核心筹备`;
        }
        
        // 选择客户
        window.selectClient = function selectClient(clientId) {
            currentClientId = clientId;
            currentClient = clients.find(client => client.id === clientId);
            updateClientDetails();
            updatePreparationClientTitle();
            renderAllTables();
        }
        
        // 添加新客户
        function addClient() {
            const newClient = {
                id: Date.now().toString(),
                groomName: '新新郎',
                brideName: '新新娘',
                weddingDate: new Date().toISOString().split('T')[0],
                venue: '待定',
                venueAddress: '',
                status: 'green',
                groomPhone: '',
                groomAddress: '',
                bridePhone: '',
                brideAddress: '',
                fee: '',
                theme: ''
            };
            
            clients.push(newClient);
            schedules.push(newClient);
            saveData();
            renderAllTables();
            selectClient(newClient.id);
        }
        
        // 删除客户
        function deleteClient(clientId) {
            if (confirm('确定要删除这个客户吗？')) {
                clients = clients.filter(client => client.id !== clientId);
                schedules = schedules.filter(schedule => schedule.id !== clientId);
                saveData();
                renderAllTables();
                
                // 如果删除的是当前客户，重置当前客户
                if (currentClientId === clientId) {
                    currentClientId = clients.length > 0 ? clients[0].id : null;
                    currentClient = clients.length > 0 ? clients[0] : null;
                    updateClientDetails();
                    updatePreparationClientTitle();
                }
            }
        }
        
        // 更新客户状态
        function updateClientStatus(clientId, status) {
            const client = clients.find(client => client.id === clientId);
            if (client) {
                client.status = status;
                saveData();
                renderAllTables();
            }
        }
        
        // 渲染客户表格
        function renderClientsTable() {
            const tbody = document.getElementById('clientsTableBody');
            tbody.innerHTML = '';
            
            clients.forEach(client => {
                const row = document.createElement('tr');
                row.style.cursor = 'pointer';
                row.addEventListener('click', function() {
                    selectClient(client.id);
                    // 切换到客户详情选项卡
                    switchTab('client-details');
                    // 滚动到客户详情页面顶部
                    document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
                row.innerHTML = `
                    <td>
                        <select class="status-select" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--gray); cursor: pointer;">
                            <option value="green" ${client.status === 'green' ? 'selected' : ''}>进行中</option>
                            <option value="yellow" ${client.status === 'yellow' ? 'selected' : ''}>待确认</option>
                            <option value="red" ${client.status === 'red' ? 'selected' : ''}>已取消</option>
                        </select>
                    </td>
                    <td>${client.groomName} & ${client.brideName}</td>
                    <td>${formatDate(client.weddingDate)}</td>
                    <td>${client.venue}</td>
                    <td style="cursor: auto;">
                        <button class="btn btn-primary btn-small">
                            <i class="fas fa-eye"></i> 查看详情
                        </button>
                        <button class="btn btn-secondary btn-small" style="margin-left: 5px;">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
                
                // 为状态选择器添加事件监听器
                const statusSelect = row.querySelector('.status-select');
                statusSelect.addEventListener('change', function(event) {
                    event.stopPropagation();
                    updateClientStatus(client.id, this.value);
                });
                
                // 为编辑按钮添加事件监听器
                const editButton = row.querySelector('.btn-primary');
                editButton.addEventListener('click', function(event) {
                    event.stopPropagation();
                    selectClient(client.id);
                });
                
                // 为删除按钮添加事件监听器
                const deleteButton = row.querySelector('.btn-secondary');
                deleteButton.addEventListener('click', function(event) {
                    event.stopPropagation();
                    deleteClient(client.id);
                });
            });
        }
        
        // 获取状态文本
        function getStatusText(status) {
            switch(status) {
                case 'green': return '进行中';
                case 'yellow': return '待确认';
                case 'red': return '已取消';
                default: return '进行中';
            }
        }
        
        // 格式化日期
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }
        
        // 渲染日历
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('currentMonth').textContent = `${year}年${month + 1}月`;
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            // 添加星期标题
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
            weekdays.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                calendarGrid.appendChild(header);
            });
            
            // 获取当月第一天和最后一天
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // 获取当月第一天是星期几
            const startDay = firstDay.getDay();
            
            // 添加空白单元格
            for (let i = 0; i < startDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                calendarGrid.appendChild(emptyDay);
            }
            
            // 添加日期单元格
            for (let i = 1; i <= lastDay.getDate(); i++) {
                const day = document.createElement('div');
                day.className = 'calendar-day';
                day.innerHTML = `<div class="day-number">${i}</div><div class="day-events"></div><button class="add-event-btn" title="添加档期"><i class="fas fa-plus"></i></button>`;
                
                // 添加点击事件，点击日期即可查看或添加档期信息
                day.addEventListener('click', function(event) {
                    // 点击添加按钮时不触发此事件
                    if (event.target.closest('.add-event-btn')) return;
                    
                    // 获取当前点击的日期
                    const selectedDate = new Date(year, month, i);
                    const formattedDate = selectedDate.toISOString().split('T')[0];
                    
                    // 检查是否有该日期的档期
                    const existingSchedules = schedules.filter(schedule => schedule.weddingDate === formattedDate);
                    
                    if (existingSchedules.length > 0) {
                        // 如果有档期，直接跳转到第一个档期的客户详情
                        const firstSchedule = existingSchedules[0];
                        selectClient(firstSchedule.id);
                        switchTab('client-details');
                        document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    } else {
                        // 如果没有档期，打开添加档期模态框
                        document.getElementById('addScheduleModal').classList.add('active');
                        // 设置默认日期为当前点击的日期
                        document.getElementById('weddingDate').value = formattedDate;
                    }
                });
                
                calendarGrid.appendChild(day);
            }
        }
        
        // 渲染档期列表
        function renderScheduleList() {
            const scheduleList = document.getElementById('scheduleList');
            scheduleList.innerHTML = '';
            
            if (schedules.length === 0) {
                scheduleList.innerHTML = '<div class="empty-state"><i class="fas fa-calendar-alt"></i><p>暂无档期，请添加新档期</p></div>';
                return;
            }
            
            // 按月份分组
            const schedulesByMonth = schedules.reduce((groups, schedule) => {
                const date = new Date(schedule.weddingDate);
                const monthKey = `${date.getFullYear()}-${date.getMonth()}`;
                if (!groups[monthKey]) {
                    groups[monthKey] = [];
                }
                groups[monthKey].push(schedule);
                return groups;
            }, {});
            
            // 渲染每个月份的档期
            Object.keys(schedulesByMonth).forEach(monthKey => {
                const [year, month] = monthKey.split('-').map(Number);
                const monthSchedules = schedulesByMonth[monthKey];
                
                const monthSection = document.createElement('div');
                monthSection.className = 'month-section';
                
                const monthHeader = document.createElement('div');
                monthHeader.className = 'month-header';
                monthHeader.textContent = `${year}年${month + 1}月`;
                monthSection.appendChild(monthHeader);
                
                const monthEvents = document.createElement('div');
                monthEvents.className = 'month-events';
                
                monthSchedules.forEach(schedule => {
                    const eventItem = document.createElement('div');
                    eventItem.className = 'event-item';
                    eventItem.style.cursor = 'pointer';
                    eventItem.addEventListener('click', function() {
                        // 选择该客户
                        selectClient(schedule.id);
                        // 切换到核心筹备选项卡
                        switchTab('preparation');
                        // 滚动到页面顶部
                        document.getElementById('preparation').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    });
                    
                    const date = new Date(schedule.weddingDate);
                    eventItem.innerHTML = `
                        <div class="event-date">
                            <div class="event-day">${date.getDate()}</div>
                            <div class="event-month">${date.toLocaleString('zh-CN', { month: 'short' })}</div>
                        </div>
                        <div class="event-info">
                            <div class="event-couple">${schedule.groomName} & ${schedule.brideName}</div>
                            <div class="event-details">
                                <span><i class="fas fa-map-marker-alt"></i> ${schedule.venue}</span>
                            </div>
                        </div>
                        <div class="event-actions">
                            <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); selectClient('${schedule.id}'); switchTab('client-details'); document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });">
                                <i class="fas fa-edit"></i> 编辑
                            </button>
                        </div>
                    `;
                    monthEvents.appendChild(eventItem);
                });
                
                monthSection.appendChild(monthEvents);
                scheduleList.appendChild(monthSection);
            });
        }
        
        // 导出当前页为图片
        function exportCurrentPageImage() {
            const targetElement = document.querySelector('.tab-content.active');
            if (!targetElement) return;
            
            html2canvas(targetElement, {
                scale: 4,
                useCORS: true,
                allowTaint: true,
                backgroundColor: '#fff9f9',
                removeContainer: true,
                useRecursiveClone: true,
                logging: false,
                onclone: function(cloneDoc) {
                    // 确保克隆的文档中所有样式都正确应用
                    cloneDoc.body.style.padding = '20px';
                    cloneDoc.body.style.backgroundColor = '#fff9f9';
                }
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `婚礼筹备_${formatDateForFilename()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error('导出图片失败:', err);
                alert('导出图片失败，请重试');
            });
        }
        
        // 导出当前客户Excel表格
        function exportCurrentClientExcel() {
            if (!currentClient) {
                alert('请先选择一个客户！');
                return;
            }
            
            // 创建工作簿
            const wb = XLSX.utils.book_new();
            
            // 客户基本信息表
            const clientInfo = [
                ['新人姓名', `${currentClient.groomName} & ${currentClient.brideName}`],
                ['婚礼日期', formatDate(currentClient.weddingDate)],
                ['婚礼酒店', currentClient.venue],
                ['酒店地址', currentClient.venueAddress],
                ['婚礼主题', currentClient.theme || ''],
                ['服务费用', currentClient.fee || '']
            ];
            
            const clientInfoSheet = XLSX.utils.aoa_to_sheet(clientInfo);
            XLSX.utils.book_append_sheet(wb, clientInfoSheet, '客户基本信息');
            
            // 男方信息表
            const groomInfo = [
                ['男方姓名', currentClient.groomName],
                ['联系方式', currentClient.groomPhone || ''],
                ['住址', currentClient.groomAddress || '']
            ];
            
            const groomInfoSheet = XLSX.utils.aoa_to_sheet(groomInfo);
            XLSX.utils.book_append_sheet(wb, groomInfoSheet, '男方信息');
            
            // 女方信息表
            const brideInfo = [
                ['女方姓名', currentClient.brideName],
                ['联系方式', currentClient.bridePhone || ''],
                ['住址', currentClient.brideAddress || '']
            ];
            
            const brideInfoSheet = XLSX.utils.aoa_to_sheet(brideInfo);
            XLSX.utils.book_append_sheet(wb, brideInfoSheet, '女方信息');
            
            // 导出Excel文件
            XLSX.writeFile(wb, `${currentClient.groomName}_${currentClient.brideName}_婚礼信息_${formatDateForFilename()}.xlsx`);
        }
        
        // 导出所有客户Excel表格
        function exportAllClientsExcel() {
            if (clients.length === 0) {
                alert('没有客户数据！');
                return;
            }
            
            // 创建工作簿
            const wb = XLSX.utils.book_new();
            
            // 所有客户列表
            const clientsList = [
                ['编号', '新人姓名', '婚礼日期', '婚礼酒店', '婚礼主题', '服务费用', '状态']
            ];
            
            clients.forEach((client, index) => {
                clientsList.push([
                    index + 1,
                    `${client.groomName} & ${client.brideName}`,
                    formatDate(client.weddingDate),
                    client.venue,
                    client.theme || '',
                    client.fee || '',
                    getStatusText(client.status)
                ]);
            });
            
            const clientsListSheet = XLSX.utils.aoa_to_sheet(clientsList);
            XLSX.utils.book_append_sheet(wb, clientsListSheet, '所有客户列表');
            
            // 导出Excel文件
            XLSX.writeFile(wb, `所有客户信息_${formatDateForFilename()}.xlsx`);
        }
        
        // 格式化日期为文件名
        function formatDateForFilename() {
            const date = new Date();
            return date.toISOString().slice(0, 19).replace(/:/g, '-').replace('T', '_');
        }
        
        // 保存当前进度
        function savePreparation() {
            saveData();
            alert('当前进度已保存！');
        }
        
        // 更新进度条
        function updateProgress() {
            // 计算所有状态复选框的总数
            const allCheckboxes = document.querySelectorAll('.status-checkbox');
            const totalCheckboxes = allCheckboxes.length;
            
            // 计算已勾选的复选框数量
            const checkedCheckboxes = document.querySelectorAll('.status-checkbox:checked');
            const checkedCount = checkedCheckboxes.length;
            
            // 计算进度百分比
            const progressPercent = totalCheckboxes > 0 ? Math.round((checkedCount / totalCheckboxes) * 100) : 0;
            
            // 更新进度条
            const progressFill = document.getElementById('progressFill');
            const progressPercentText = document.getElementById('progressPercent');
            
            if (progressFill && progressPercentText) {
                progressFill.style.width = `${progressPercent}%`;
                progressPercentText.textContent = `${progressPercent}%`;
            }
        }
        
        // 搜索客户
        function searchClients() {
            const searchTerm = document.getElementById('clientSearch').value.toLowerCase();
            const filteredClients = clients.filter(client => {
                // 搜索新郎姓名、新娘姓名
                const nameMatch = client.groomName.toLowerCase().includes(searchTerm) ||
                                  client.brideName.toLowerCase().includes(searchTerm);
                
                // 搜索婚礼地点
                const venueMatch = client.venue.toLowerCase().includes(searchTerm);
                
                // 搜索婚礼日期（格式化和原始格式）
                const formattedDate = formatDate(client.weddingDate).toLowerCase();
                const originalDate = client.weddingDate.toLowerCase();
                const dateMatch = formattedDate.includes(searchTerm) || originalDate.includes(searchTerm);
                
                // 搜索新人电话
                const phoneMatch = (client.groomPhone && client.groomPhone.toLowerCase().includes(searchTerm)) ||
                                  (client.bridePhone && client.bridePhone.toLowerCase().includes(searchTerm));
                
                // 搜索婚礼主题
                const themeMatch = client.theme && client.theme.toLowerCase().includes(searchTerm);
                
                // 搜索服务费用
                const feeMatch = client.fee && client.fee.toLowerCase().includes(searchTerm);
                
                // 综合所有匹配条件
                return nameMatch || venueMatch || dateMatch || phoneMatch || themeMatch || feeMatch;
            });
            
            // 渲染搜索结果
            const tbody = document.getElementById('clientsTableBody');
            tbody.innerHTML = '';
            
            filteredClients.forEach(client => {
                const row = document.createElement('tr');
                // 添加高亮样式
                row.className = 'search-result';
                row.style.cursor = 'pointer';
                row.addEventListener('click', function() {
                    selectClient(client.id);
                    // 切换到客户详情选项卡
                    switchTab('client-details');
                    // 滚动到客户详情页面顶部
                    document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
                row.innerHTML = `
                    <td>
                        <select class="status-select" style="padding: 4px 8px; border-radius: 4px; border: 1px solid var(--gray); cursor: pointer;">
                            <option value="green" ${client.status === 'green' ? 'selected' : ''}>进行中</option>
                            <option value="yellow" ${client.status === 'yellow' ? 'selected' : ''}>待确认</option>
                            <option value="red" ${client.status === 'red' ? 'selected' : ''}>已取消</option>
                        </select>
                    </td>
                    <td>${client.groomName} & ${client.brideName}</td>
                    <td>${formatDate(client.weddingDate)}</td>
                    <td>${client.venue}</td>
                    <td style="cursor: auto;">
                        <button class="btn btn-primary btn-small">
                            <i class="fas fa-eye"></i> 查看详情
                        </button>
                        <button class="btn btn-secondary btn-small" style="margin-left: 5px;">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
                
                // 为状态选择器添加事件监听器
                const statusSelect = row.querySelector('.status-select');
                statusSelect.addEventListener('change', function(event) {
                    event.stopPropagation();
                    updateClientStatus(client.id, this.value);
                });
                
                // 为编辑按钮添加事件监听器
                const editButton = row.querySelector('.btn-primary');
                editButton.addEventListener('click', function(event) {
                    event.stopPropagation();
                    selectClient(client.id);
                    switchTab('client-details');
                    document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
                
                // 为删除按钮添加事件监听器
                const deleteButton = row.querySelector('.btn-secondary');
                deleteButton.addEventListener('click', function(event) {
                    event.stopPropagation();
                    deleteClient(client.id);
                });
            });
            
            // 如果只有一个搜索结果，直接跳转到该客户详情
            if (filteredClients.length === 1 && searchTerm.trim() !== '') {
                selectClient(filteredClients[0].id);
                switchTab('client-details');
                document.getElementById('client-details').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // 添加档期
        function addSchedule(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const schedule = {
                id: Date.now().toString(),
                groomName: formData.get('groomName'),
                brideName: formData.get('brideName'),
                weddingDate: formData.get('weddingDate'),
                venue: formData.get('venue'),
                venueAddress: formData.get('venueAddress'),
                status: 'green'
            };
            
            clients.push(schedule);
            schedules.push(schedule);
            saveData();
            renderAllTables();
            
            // 关闭模态框
            document.getElementById('addScheduleModal').classList.remove('active');
            event.target.reset();
        }
        
        // 初始化UI
        function initializeUI() {
            // 加载数据
            loadSavedData();
            
            // 渲染日历和列表
            renderCalendar();
            renderScheduleList();
        }
        
        // 事件监听器
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化UI
            initializeUI();
            
            // 导航选项卡切换
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // 子选项卡切换
            document.querySelectorAll('.sub-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const subtabName = this.getAttribute('data-subtab');
                    window.switchSubTab(subtabName);
                    // 滚动到相应清单位置
                    document.getElementById(subtabName).scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            });
            
            // 快速导航按钮
            document.querySelectorAll('.nav-card').forEach(card => {
                card.addEventListener('click', function() {
                    // 已经在HTML中设置了onclick事件
                    // 这里不需要重复处理
                });
            });
            
            // 导出选项按钮
            document.getElementById('exportOptionsBtn').addEventListener('click', function() {
                document.getElementById('exportOptionsModal').classList.add('active');
            });
            
            // 导出图片按钮
            document.getElementById('exportImageBtn').addEventListener('click', function() {
                exportCurrentPageImage();
                document.getElementById('exportOptionsModal').classList.remove('active');
            });
            
            // 管家档期按钮点击事件
            function updateScheduleCounts() {
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();
                
                // 计算本月档期数量
                const thisMonthSchedules = schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.weddingDate);
                    return scheduleDate.getMonth() === currentMonth && scheduleDate.getFullYear() === currentYear;
                });
                document.getElementById('thisMonthCount').textContent = thisMonthSchedules.length;
                
                // 计算全年档期数量
                const fullYearSchedules = schedules.filter(schedule => {
                    const scheduleDate = new Date(schedule.weddingDate);
                    return scheduleDate.getFullYear() === currentYear;
                });
                document.getElementById('fullYearCount').textContent = fullYearSchedules.length;
                
                // 计算本月收入
                const monthlyIncome = thisMonthSchedules.reduce((total, schedule) => {
                    const fee = parseFloat(schedule.fee?.replace(/[^0-9.]/g, '')) || 0;
                    return total + fee;
                }, 0);
                document.getElementById('monthlyIncomeCount').textContent = `¥${monthlyIncome.toFixed(0)}`;
            }
            
            // 切换视图函数
            function switchView(viewType) {
                if (viewType === 'list') {
                    document.getElementById('listView').classList.add('active');
                    document.getElementById('calendarView').classList.remove('active');
                    document.getElementById('statsChartContainer').classList.remove('active');
                    document.getElementById('listViewBtn').classList.add('active');
                    document.getElementById('calendarViewBtn').classList.remove('active');
                    document.getElementById('statsViewBtn').classList.remove('active');
                    currentView = 'list';
                    renderScheduleList();
                } else if (viewType === 'calendar') {
                    document.getElementById('calendarView').classList.add('active');
                    document.getElementById('listView').classList.remove('active');
                    document.getElementById('statsChartContainer').classList.remove('active');
                    document.getElementById('calendarViewBtn').classList.add('active');
                    document.getElementById('listViewBtn').classList.remove('active');
                    document.getElementById('statsViewBtn').classList.remove('active');
                    currentView = 'calendar';
                } else if (viewType === 'stats') {
                    document.getElementById('statsChartContainer').classList.add('active');
                    document.getElementById('calendarView').classList.remove('active');
                    document.getElementById('listView').classList.remove('active');
                    document.getElementById('statsViewBtn').classList.add('active');
                    document.getElementById('calendarViewBtn').classList.remove('active');
                    document.getElementById('listViewBtn').classList.remove('active');
                    currentView = 'stats';
                }
            }
            
            // 本月档期按钮
            document.getElementById('thisMonthBtn').addEventListener('click', function() {
                this.classList.add('active');
                setTimeout(() => this.classList.remove('active'), 200);
                // 跳转到列表视图
                switchTab('schedule');
                switchView('list');
                updateScheduleCounts();
                // 突出显示本月档期
                highlightCurrentMonthSchedules();
            });
            
            // 全年档期按钮
            document.getElementById('fullYearBtn').addEventListener('click', function() {
                this.classList.add('active');
                setTimeout(() => this.classList.remove('active'), 200);
                // 跳转到列表视图
                switchTab('schedule');
                switchView('list');
                updateScheduleCounts();
                // 显示全年档期
                showAllYearSchedules();
            });
            
            // 本月收入按钮
            document.getElementById('monthlyIncomeBtn').addEventListener('click', function() {
                this.classList.add('active');
                setTimeout(() => this.classList.remove('active'), 200);
                // 跳转到列表视图
                switchTab('schedule');
                switchView('list');
                updateScheduleCounts();
                // 突出显示本月收入相关档期
                highlightMonthlyIncomeSchedules();
            });
            
            // 突出显示本月档期
            function highlightCurrentMonthSchedules() {
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();
                
                // 移除所有突出显示
                document.querySelectorAll('.event-item').forEach(item => {
                    item.style.backgroundColor = '';
                });
                
                // 突出显示本月档期
                document.querySelectorAll('.event-item').forEach(item => {
                    const dateText = item.querySelector('.event-day').textContent;
                    const monthText = item.querySelector('.event-month').textContent;
                    const monthMap = {'1月': 0, '2月': 1, '3月': 2, '4月': 3, '5月': 4, '6月': 5, '7月': 6, '8月': 7, '9月': 8, '10月': 9, '11月': 10, '12月': 11};
                    const itemMonth = monthMap[monthText];
                    
                    if (itemMonth === currentMonth) {
                        item.style.backgroundColor = 'rgba(231, 76, 60, 0.1)';
                        item.style.borderLeft = '4px solid var(--primary-color)';
                    }
                });
            }
            
            // 显示全年档期
            function showAllYearSchedules() {
                // 移除所有突出显示
                document.querySelectorAll('.event-item').forEach(item => {
                    item.style.backgroundColor = '';
                    item.style.borderLeft = '';
                });
            }
            
            // 突出显示本月收入相关档期
            function highlightMonthlyIncomeSchedules() {
                const now = new Date();
                const currentMonth = now.getMonth();
                const currentYear = now.getFullYear();
                
                // 移除所有突出显示
                document.querySelectorAll('.event-item').forEach(item => {
                    item.style.backgroundColor = '';
                });
                
                // 突出显示本月档期
                document.querySelectorAll('.event-item').forEach(item => {
                    const dateText = item.querySelector('.event-day').textContent;
                    const monthText = item.querySelector('.event-month').textContent;
                    const monthMap = {'1月': 0, '2月': 1, '3月': 2, '4月': 3, '5月': 4, '6月': 5, '7月': 6, '8月': 7, '9月': 8, '10月': 9, '11月': 10, '12月': 11};
                    const itemMonth = monthMap[monthText];
                    
                    if (itemMonth === currentMonth) {
                        item.style.backgroundColor = 'rgba(46, 204, 113, 0.1)';
                        item.style.borderLeft = '4px solid var(--success-color)';
                    }
                });
            }
            
            // 初始化档期计数
            updateScheduleCounts();
            
            // 导出当前客户Excel表格按钮
            document.getElementById('exportClientExcelBtn').addEventListener('click', function() {
                exportCurrentClientExcel();
                document.getElementById('exportOptionsModal').classList.remove('active');
            });
            
            // 导出所有客户Excel表格按钮
            document.getElementById('exportAllClientsExcelBtn').addEventListener('click', function() {
                exportAllClientsExcel();
                document.getElementById('exportOptionsModal').classList.remove('active');
            });
            
            // 保存按钮
            document.getElementById('savePreparationBtn').addEventListener('click', savePreparation);
            
            // 添加档期按钮
            document.getElementById('addScheduleBtn').addEventListener('click', function() {
                document.getElementById('addScheduleModal').classList.add('active');
            });
            
            // 取消添加档期
            document.getElementById('cancelAddSchedule').addEventListener('click', function() {
                document.getElementById('addScheduleModal').classList.remove('active');
            });
            
            // 添加档期表单提交
            document.getElementById('addScheduleForm').addEventListener('submit', addSchedule);
            
            // 模态框关闭
            document.querySelectorAll('.modal-close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal').classList.remove('active');
                });
            });
            
            // 点击模态框外部关闭
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            });
            
            // 客户搜索
            document.getElementById('clientSearch').addEventListener('input', searchClients);
            
            // 刷新客户列表
            document.getElementById('refreshClients').addEventListener('click', renderClientsTable);
            
            // 日历视图切换
            document.getElementById('calendarViewBtn').addEventListener('click', function() {
                document.getElementById('calendarView').classList.add('active');
                document.getElementById('listView').classList.remove('active');
                document.getElementById('statsChartContainer').classList.remove('active');
                this.classList.add('active');
                document.getElementById('listViewBtn').classList.remove('active');
                document.getElementById('statsViewBtn').classList.remove('active');
                currentView = 'calendar';
            });
            
            // 列表视图切换
            document.getElementById('listViewBtn').addEventListener('click', function() {
                document.getElementById('listView').classList.add('active');
                document.getElementById('calendarView').classList.remove('active');
                document.getElementById('statsChartContainer').classList.remove('active');
                this.classList.add('active');
                document.getElementById('calendarViewBtn').classList.remove('active');
                document.getElementById('statsViewBtn').classList.remove('active');
                currentView = 'list';
                renderScheduleList();
            });
            
            // 统计视图切换
            document.getElementById('statsViewBtn').addEventListener('click', function() {
                document.getElementById('statsChartContainer').classList.add('active');
                document.getElementById('calendarView').classList.remove('active');
                document.getElementById('listView').classList.remove('active');
                this.classList.add('active');
                document.getElementById('calendarViewBtn').classList.remove('active');
                document.getElementById('listViewBtn').classList.remove('active');
                currentView = 'stats';
            });
            
            // 日历导航
            document.getElementById('prevMonthBtn').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });
            
            document.getElementById('nextMonthBtn').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            // 添加档期按钮
            document.getElementById('addEventBtn').addEventListener('click', function() {
                document.getElementById('addScheduleModal').classList.add('active');
            });
            
            // 保存筹备进度按钮
            document.getElementById('savePreparationBtn').addEventListener('click', savePreparation);
            
            // 保存婚礼当天进度按钮
            document.getElementById('saveDayOfBtn').addEventListener('click', function() {
                saveData();
                alert('婚礼当天进度已保存！');
            });
            
            // 确保所有按钮事件监听器都正确绑定
            console.log('所有事件监听器已绑定');
            
            // 为所有添加按钮添加事件监听器
            const addButtons = document.querySelectorAll('button[onclick^="add"]');
            addButtons.forEach(button => {
                console.log('添加按钮:', button.textContent.trim());
            });
            
            // 为所有状态复选框添加事件监听器，用于更新进度条
            const statusCheckboxes = document.querySelectorAll('.status-checkbox');
            statusCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', updateProgress);
            });
            
            // 初始化时更新进度条
            updateProgress();
        
        // 常用联系人功能
        window.addContact = function() {
            const contactsList = document.getElementById('contactsList');
            const contactItem = document.createElement('div');
            contactItem.className = 'contact-item';
            contactItem.style = 'background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);';
            contactItem.innerHTML = `
                <div style="font-weight: 700; color: var(--dark-color); margin-bottom: 5px;" contenteditable="true">新联系人</div>
                <div style="color: var(--gray-dark); margin-bottom: 5px;" contenteditable="true">职位</div>
                <div style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;" contenteditable="true">电话</div>
                <button class="btn btn-secondary btn-small" onclick="deleteContact(this)">
                    <i class="fas fa-trash"></i> 删除
                </button>
            `;
            contactsList.appendChild(contactItem);
        }
        
        window.deleteContact = function(button) {
            button.closest('.contact-item').remove();
        }
        
        // 婚礼小知识功能
        window.addWeddingTip = function() {
            const weddingTips = document.getElementById('weddingTips');
            const tipItem = document.createElement('div');
            tipItem.className = 'tip-item';
            tipItem.style = 'background-color: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow);';
            tipItem.innerHTML = `
                <h4 style="margin-bottom: 10px; color: var(--dark-color); font-size: 16px;" contenteditable="true">新标题</h4>
                <p style="color: var(--gray-dark); font-size: 14px; line-height: 1.6; margin-bottom: 10px;" contenteditable="true">新内容</p>
                <button class="btn btn-secondary btn-small" onclick="deleteWeddingTip(this)">
                    <i class="fas fa-trash"></i> 删除
                </button>
            `;
            weddingTips.appendChild(tipItem);
        }
        
        window.deleteWeddingTip = function(button) {
            button.closest('.tip-item').remove();
        }
        
        // 家庭责任清单功能
        window.addFamilyTask = function(type) {
            const tbody = document.getElementById(type === 'groom' ? 'groomFamilyTasksTableBody' : 'brideFamilyTasksTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="checkbox" class="status-checkbox"></td>
                <td contenteditable="true">新责任</td>
                <td contenteditable="true">负责人</td>
                <td contenteditable="true">联系方式</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteFamilyTask(this, '${type}')">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 为新添加的状态复选框添加事件监听器
            const checkbox = row.querySelector('.status-checkbox');
            checkbox.addEventListener('change', updateProgress);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteFamilyTask = function(button, type) {
            button.closest('tr').remove();
            updateProgress();
        }
        
        // 新娘嫁妆清单功能
        window.addDowryItem = function() {
            const tbody = document.getElementById('dowryTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="checkbox" class="status-checkbox"></td>
                <td contenteditable="true">新嫁妆</td>
                <td contenteditable="true">数量</td>
                <td contenteditable="true">价值</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteDowryItem(this)">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 为新添加的状态复选框添加事件监听器
            const checkbox = row.querySelector('.status-checkbox');
            checkbox.addEventListener('change', updateProgress);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteDowryItem = function(button) {
            button.closest('tr').remove();
            updateProgress();
        }
        
        // 新郎物资清单功能
        window.addGroomSupply = function() {
            const tbody = document.getElementById('groomSuppliesTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="checkbox" class="status-checkbox"></td>
                <td contenteditable="true">新物资</td>
                <td contenteditable="true">数量</td>
                <td contenteditable="true">预算</td>
                <td contenteditable="true">购买地点</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteGroomSupply(this)">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 为新添加的状态复选框添加事件监听器
            const checkbox = row.querySelector('.status-checkbox');
            checkbox.addEventListener('change', updateProgress);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteGroomSupply = function(button) {
            button.closest('tr').remove();
            updateProgress();
        }
        
        // 备婚时间表功能
        window.addTimelineItem = function() {
            const container = document.getElementById('timelineContainer');
            const item = document.createElement('div');
            item.className = 'timeline-item';
            item.contentEditable = true;
            item.innerHTML = `
                <div class="timeline-time">新时间节点</div>
                <div class="timeline-content">
                    <h4>标题</h4>
                    <p>内容</p>
                </div>
            `;
            container.appendChild(item);
            // 聚焦到新添加的时间节点
            item.querySelector('.timeline-time').focus();
        }
        
        // 工作人员安排功能
        window.addStaffMember = function() {
            const tbody = document.getElementById('staffTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td contenteditable="true">姓名</td>
                <td contenteditable="true">职位</td>
                <td contenteditable="true">联系方式</td>
                <td contenteditable="true">职责描述</td>
                <td contenteditable="true">费用</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteStaffMember(this)">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteStaffMember = function(button) {
            button.closest('tr').remove();
        }
        
        // 供应商管理功能
        window.addVendor = function() {
            const tbody = document.getElementById('vendorsTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td contenteditable="true">供应商名称</td>
                <td contenteditable="true">联系人</td>
                <td contenteditable="true">联系方式</td>
                <td contenteditable="true">提供服务</td>
                <td contenteditable="true">费用</td>
                <td contenteditable="true">地址</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteVendor(this)">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteVendor = function(button) {
            button.closest('tr').remove();
        }
        
        // 预算管理功能
        window.addBudgetItem = function() {
            const tbody = document.getElementById('budgetTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td contenteditable="true">项目类别</td>
                <td contenteditable="true">项目名称</td>
                <td contenteditable="true">预算金额</td>
                <td contenteditable="true">实际支出</td>
                <td style="color: var(--info-color); font-weight: 600;">¥0</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteBudgetItem(this)">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteBudgetItem = function(button) {
            button.closest('tr').remove();
        }
        
        // 最终检查清单功能
        window.addChecklistItem = function() {
            const dayOfSection = document.getElementById('checklistDayOf');
            const item = document.createElement('div');
            item.className = 'checklist-item';
            item.style.display = 'flex';
            item.style.alignItems = 'center';
            item.style.gap = '10px';
            item.style.marginBottom = '10px';
            item.style.padding = '10px';
            item.style.backgroundColor = 'var(--light-color)';
            item.style.borderRadius = 'var(--border-radius)';
            item.innerHTML = `
                <input type="checkbox" class="status-checkbox">
                <div style="flex: 1;" contenteditable="true">新检查项目</div>
            `;
            dayOfSection.appendChild(item);
            // 为新添加的状态复选框添加事件监听器
            const checkbox = item.querySelector('.status-checkbox');
            checkbox.addEventListener('change', updateProgress);
            // 聚焦到新添加的检查项目
            item.querySelector('div[contenteditable="true"]').focus();
        }
        
        // 婚礼当天功能
        window.addDayOfItem = function(type = 'common') {
            let tbodyId;
            switch(type) {
                case 'groom':
                    tbodyId = 'groomDayOfScheduleTableBody';
                    break;
                case 'bride':
                    tbodyId = 'brideDayOfScheduleTableBody';
                    break;
                case 'common':
                default:
                    tbodyId = 'commonDayOfScheduleTableBody';
                    break;
            }
            
            const tbody = document.getElementById(tbodyId);
            const row = document.createElement('tr');
            row.innerHTML = `
                <td contenteditable="true">00:00</td>
                <td contenteditable="true">新环节</td>
                <td contenteditable="true">地点</td>
                <td contenteditable="true">负责人</td>
                <td contenteditable="true">备注</td>
                <td>
                    <button class="btn btn-secondary btn-small" onclick="deleteDayOfItem(this, '${type}')">
                        <i class="fas fa-trash"></i> 删除
                    </button>
                </td>
            `;
            tbody.appendChild(row);
            // 聚焦到新添加行的第一个可编辑单元格
            row.querySelector('td[contenteditable="true"]').focus();
        }
        
        window.deleteDayOfItem = function(button, type = 'common') {
            button.closest('tr').remove();
        }
        
        // 倒计时计算器功能
        function calculateCountdown() {
            const weddingDateInput = document.getElementById('weddingDateInput');
            const countdownResult = document.getElementById('countdownResult');
            
            if (!weddingDateInput.value) {
                countdownResult.innerHTML = `
                    <div style="font-size: 36px; font-weight: 700; color: var(--primary-color); margin-bottom: 10px;">0</div>
                    <div style="color: var(--dark-color);">天</div>
                `;
                return;
            }
            
            const weddingDate = new Date(weddingDateInput.value);
            const today = new Date();
            const timeDiff = weddingDate - today;
            const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
            
            countdownResult.innerHTML = `
                <div style="font-size: 36px; font-weight: 700; color: var(--primary-color); margin-bottom: 10px;">${daysDiff}</div>
                <div style="color: var(--dark-color);">天</div>
            `;
        }
        
        // 预算计算器功能
        document.getElementById('calculateBudgetBtn').addEventListener('click', function() {
            const totalBudgetInput = document.getElementById('totalBudgetInput');
            const expensesInput = document.getElementById('expensesInput');
            const budgetResult = document.getElementById('budgetResult');
            
            const totalBudget = parseFloat(totalBudgetInput.value) || 0;
            const expenses = parseFloat(expensesInput.value) || 0;
            const remaining = totalBudget - expenses;
            const percentage = totalBudget > 0 ? Math.round((remaining / totalBudget) * 100) : 0;
            
            const color = remaining >= 0 ? 'var(--success-color)' : 'var(--primary-color)';
            
            budgetResult.innerHTML = `
                <div style="font-size: 24px; font-weight: 700; color: ${color}; margin-bottom: 5px;">剩余预算：¥${remaining.toFixed(2)}</div>
                <div style="color: var(--dark-color); font-size: 14px;">占总预算的 ${percentage}%</div>
            `;
        });
        
        // 初始化倒计时计算器
        document.getElementById('weddingDateInput').addEventListener('input', calculateCountdown);
        
        // 设置默认婚礼日期为当前日期后3个月
        const defaultDate = new Date();
        defaultDate.setMonth(defaultDate.getMonth() + 3);
        const formattedDate = defaultDate.toISOString().split('T')[0];
        document.getElementById('weddingDateInput').value = formattedDate;
        calculateCountdown();
    });
    </script>
</body>
</html>
